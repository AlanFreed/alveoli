\setcounter{section}{0}
\part{Variational Formulation}
\label{partVariational}

The problem we have set up to solve takes on the general form of a second-order, hyperbolic, ordinary, differential equation; specifically,
\begin{equation}
	\mathbf{M} \ddot{\mathbf{u}} + \mathbf{K} \mathbf{u} = \mathbf{f}(t)
\end{equation}
where $\mathbf{M}$ is a mass matrix, $\mathbf{K}$ is a stiffness matrix, $\mathbf{f}$ is a forcing function dependent upon time $t$, and $\mathbf{u}$ is a displacement vector with $\ddot{\mathbf{u}}$ denoting acceleration.  At present, a possible contribution arising from dissipation is not included, e.g., a $\mathbf{C} \dot{\mathbf{u}}$ term accounting for visco\-elastic effects.  The numerical solution strategy employed to solve this ODE is discussed in \S\ref{sec:solve2ndOrderODE}, which requires $\mathbf{M}$ to be an invertible matrix.

A dodecahedron used to model an alveolar sac is our problem of interest.  The shape of an irregular dodecahedron is described by a set of 20 vertices, each experiencing a displacement
\begin{equation}
	\mathbf{u}_i = \{ u_{xi} , u_{yi} , u_{zi} \}^{\mathsf{T}} \defeq
    \{ x_i - x_{0i} , y_i - y_{0i} , z_i - z_{0i} \}^{\mathsf{T}} ,
    \quad i = 1, 2, \ldots , 20
\end{equation}
that contains co-ordinate differences at a dodecahedral vertex evaluated in the physical co-ordinate frame of this dodecahedron $( \vec{\mathbfsf{E}}_1 , \vec{\mathbfsf{E}}_2 , \vec{\mathbfsf{E}}_3 )$, as established in \S\ref{reindexing3D}, with each vertex $i$ having reference co-ordinates denoted as $\{ x_{0i} , y_{0i} , z_{0i} \}^{\mathsf{T}}$ and current co-ordinates denoted as $\{ x_i , y_i , z_i \}^{\mathsf{T}}$.  The 20 vertices of a dodecahedron uniquely establish its 30 alveolar chords, its 12 alveolar septa, and the alveolar sac that these chords and septa envelop, cf.\ \S\ref{sec:indexingDodecahedra}.

When assembled, vectors $\mathbf{f}$, $\mathbf{u}$ and $\ddot{\mathbf{u}}$ have lengths of 60 for the alveolar chord and septa models, and a length of 63 for the alveolar sac model, while matrices $\mathbf{M}$ and $\mathbf{K}$ have dimensions of $60 \! \times \! 60$ for the alveolar chord and septa models, and dimensions of $63 \! \times \! 63$ for the alveolar sac model.  The model for alveolar volume has an extra node located at the centroid of the dodecahedron, which is a node in common betwixt the 60 tetrahedra needed to fill the volume of a dodecahedron in our modeling of an alveolus. 

As a modeling simplification, the alveolar chords, the alveolar septa, and the alveolar sac are each modeled separately.  It is the nodal forces resulting from these three, separate, finite-element models that then are summed.  These are obtained by interpolating the stresses integrated at their Guass points out to their nodes, which belong to the set dodecahedral vertices.  These three sources for vertex force can be added, from which an uniform (homogenized) state of stress can then be calculated for return.  

Consequently, we are constructing three, individual, finite-element models governed by the following systems of hyperbolic differential equations
\begin{subequations}
    \begin{align}
    \mathbf{M}_{1D} \ddot{\mathbf{u}} + \mathbf{K}_{1D} \mathbf{u} & 
    = \mathbf{f}_{1D}(t) \\
    \mathbf{M}_{2D} \ddot{\mathbf{u}} + \mathbf{K}_{2D} \mathbf{u} & 
    = \mathbf{f}_{2D}(t) \\
    \mathbf{M}_{3D} \ddot{\mathbf{u}} + \mathbf{K}_{3D} \mathbf{u} & 
    = \mathbf{f}_{3D}(t)
    \end{align}
\end{subequations}
where subscript `$\mbox{}_{1D}$' designates alveolar chords, subscript `$\mbox{}_{2D}$' designates alveolar septa, and subscript `$\mbox{}_{3D}$' designates an alveolar sac.  It is thought to be necessary to split the overall problem into these three subproblems due to the vast differences in their compliance moduli.

\section{Mass Matrix}

A consistent mass matrix \cite{Archer65} for an element, established in its natural co-ordinate system, is defined as
\begin{equation}
	\mathbf{M}_{C} = \int_{V} \rho \, \mathbf{N}^{\mathsf{T}} \mathbf{N} \,
	\mathrm{d} V
	\label{consistentMassMatrix}
\end{equation}
wherein $\mathbf{N}$ is the shape function matrix for an element whose mass density is $\rho$.  This mass matrix is said to be consistent in that it is calculated with the same shape functions that are used to create the stiffness matrix.  Consistent mass matrices are symmetric and, sometimes, they are singular, too, which is not a desirable feature for our chosen numerical approach.

To construct a non-singular mass matrix, we introduce a lumped mass matrix.  Specifically, the sum of all row elements from each row of a consistent mass matrix establishes the diagonal elements of a lumped mass matrix \cite{Reddy93} in that
\begin{equation}
\mathbf{M}_L = \sum_{i=1}^n M_{Li} 
\quad \text{where} \quad
M_{Li} = \sum_{j=1}^n \int_{V} \rho \, N_i \, N_j \, \mathrm{d} V 
\label{lumpedMassMatrix}
\end{equation}
wherein $\sum_{j=1}^n N_j = 1$ with $i$ being a Gauss point out of the $n$ Gauss points in an element.

A lumped-consistent (or weighted) mass matrix $\mathbf{M}_W $ can then be defined as follows
\begin{equation}
\mathbf{M}_W  = (1 - \mu) \, \mathbf{M}_{C} + \mu \, \mathbf{M}_{L}
\end{equation}
wherein $\mu$ is a free scalar parameter for weighting the consistent and lumped mass matrices.  The reason for mixing $\mathbf{M}_C$ and $\mathbf{M}_L$ is that the weighted matrix $\mathbf{M}_W$ will not be singular.  Herein $\mu$ is taken to be a half, i.e., an averaged mass matrix is adopted, which has a nice property of minimizing low frequency dispersion.  Specifically,
\begin{equation}
\mathbf{M}_A  = \tfrac{1}{2} \, (\mathbf{M}_{C} + \mathbf{M}_{L})
\label{LumconsMass}
\end{equation}
is how we shall construct our mass matrices.  The averaged mass matrix $\mathbf{M}_A$ is invertible, which is a requirement of the selected numerical solution strategy presented in \S\ref{sec:solve2ndOrderODE}.

\subsection{Mass Matrices for a Chord}

A two-noded alveolar chord has shape functions $N_i$ that, when evaluated in its natural co-ordinate system wherein $-1 \leq \xi \leq 1$, aggregate into a matrix of shape functions
\begin{equation}
\mathbf{N} = \begin{bmatrix} N_1 & N_2 \end{bmatrix} =
\begin{bmatrix}
\frac{1}{2} \, (1 - \xi) &  \frac{1}{2} \, (1 + \xi)
\end{bmatrix} 
\quad \text{so that} \quad
N_{1,\xi} = -\tfrac{1}{2} 
\quad \text{and} \quad
N_{2,\xi} = \tfrac{1}{2}
\end{equation}
where $\xi$ is the abscissa associated with a specific Gauss integration rule, cf.\ Table~\ref{tabQuadrature1D}.

The Jacobian matrix $\mathbf{J}$ for a one-dimensional chord, which is also its Jacobian determinant $| \mathbf{J} |$, is used to transform the integrals in Eqns.~(\ref{consistentMassMatrix} \& \ref{lumpedMassMatrix}) from their global co-ordinate system into their natural co-ordinate system.  It has a value of
\begin{equation}
     \mathbf{J} \equiv | \mathbf{J} | = \sum\nolimits_{i=1}^2 N_{i,\xi} (\xi) \, x_i = 
     -\tfrac{1}{2} \cdot -\tfrac{1}{2} L + \tfrac{1}{2} \cdot \tfrac{1}{2} L = 
     \tfrac{1}{2} L
     \label{detJac1D}
\end{equation}
given nodal co-ordinates of $x_1 = -\tfrac{1}{2} L$ and $x_2 = \tfrac{1}{2} L$, where $L$ is the length of our alveolar chord.  The Jacobian matrix and the Jacobian determinant are equal in this case because the space is one dimensional. 

The consistent mass matrix for a 1D alveolar chord modeled as a two-noded rod, when evaluated in its natural co-ordinate system, becomes
\begin{equation}
    \begin{aligned}
    \mathbf{M}_{1C} & = \int_0^L \rho \, \mathbf{N}^{\mathsf{T}} \mathbf{N} \, A \, \mathrm{d} x  = \int_{-1}^{1} \rho \, \mathbf{N}^{\mathsf{T}} \mathbf{N}\, A \, | \mathbf{J} | \,  \mathrm{d} \xi \\
    & = \sum_{i=1}^n  \rho  \, N_i^{\mathsf{T}} N_i \, A \, | \mathbf{J} | \, w_i = \sum_{i=1}^n \frac{\rho A L w_i}{8} \begin{bmatrix}
    1 - 2\xi_i + \xi_i^2 & 1 - \xi_i^2 \\
    1 - \xi_i^2 & 1 + 2 \xi_i + \xi_i^2
    \end{bmatrix}
    \end{aligned}
    \label{ConsMassMatrix1DA}
\end{equation}
with $N_i$ and $w_i$ being the shape functions and weights of quadrature for the selected Gauss integration rule evaluated at Gauss point $i$, while $A$ is the cross-sectional area of our alveolar chord. Table~\ref{tabQuadrature1D} presents values for the absciss\ae\ $\xi_i$ and weights $w_i$ of integration for schemes where there are $n = 1, 2$ or $3$ nodes of integration along an alveolar chord.  

The lumped mass matrix for a 1D alveolar chord in its natural co-ordinate system is 
\begin{equation}
\begin{aligned}
\mathbf{M}_{1L} & = \sum_{i,j=1}^n \int_0^L \rho \, N_i \, N_j \, A \, \mathrm{d} x  = \sum_{i=1}^n \int_{-1}^{1} \rho \, N_i \, A \, | \mathbf{J} | \,  \mathrm{d} \xi \\
& = \sum_{i=1}^n  \rho  \, N_i\, A \, | \mathbf{J} | \, w_i = 
\sum_{i=1}^n \frac{\rho A L w_i}{4} \begin{bmatrix} 
1 - \xi_i & 0 \\ 0 & 1 + \xi_i \end{bmatrix}
\end{aligned}
\label{LumconsMassMatrix1DA}
\end{equation}
because $\sum_{j=1}^n N_j = 1$.  It is readily apparent that the mass matrix in Eqn.~(\ref{ConsMassMatrix1DA}) at a Gauss point is singular, whereas the mass matrix in Eqn.~(\ref{LumconsMassMatrix1DA}) has a reciprocal, except at $\xi = \pm 1$. 


Chordal mass matrices associated with the Gauss quadratures listed in Table~\ref{tabQuadrature1D} become: The consistent mass matrices for a chord are
\begin{subequations}
\label{massMatrices1D}
\begin{align}
    \mathbf{M}_{1C} & = \frac{\rho A L}{4} 
    \begin{bmatrix} 1 & 1 \\ 1 & 1 \end{bmatrix} & 
    \mathbf{M}_{1C} & = \frac{\rho A L}{6} 
    \begin{bmatrix} 2 & 1 \\ 1 & 2 \end{bmatrix} & 
    \mathbf{M}_{1C} & = \frac{\rho A L}{6} 
    \begin{bmatrix} 2 & 1 \\ 1 & 2 \end{bmatrix} 
    \label{ConsMassMatrix1D} \\
    \intertext{The lumped mass matrices for a chord are}
    \mathbf{M}_{1L} & = \frac{\rho A L}{2} 
    \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix} & 
    \mathbf{M}_{1L} & = \frac{\rho A L}{2} 
    \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix} & 
    \mathbf{M}_{1L} & = \frac{\rho A L}{2} 
    \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix} 
    \label{LumMassMatrix1D} \\
    \intertext{When averaged these mass matrices become}
    \mathbf{M}_{1A} & = \frac{\rho A L}{8} 
    \begin{bmatrix} 3 & 1 \\ 1 & 3 \end{bmatrix} & 
    \mathbf{M}_{1A} & = \frac{\rho A L}{12} 
    \begin{bmatrix} 5 & 1 \\ 1 & 5 \end{bmatrix} & 
    \mathbf{M}_{1A} & = \frac{\rho A L}{12} 
    \begin{bmatrix} 5 & 1 \\ 1 & 5 \end{bmatrix}
    \label{avgMassMatrix1D}
\end{align}
\end{subequations}
which are the mass matrices that we employ.  This collection of mass matrices pertain to one Gauss point (left set of mass matrices), two Gauss points (center set of mass matrices), and three Gauss points (right set of mass matrices).  For this element, there is no difference between the mass matrices for two and three Gauss points of integration.  In the derivation of these matrices, it is assumed that the cross-sectional area and mass density  are both uniform along the length of a septal chord.  Furthermore, because septal chord volume $V$ is considered to be preserved, i.e., $V = V_0$ where $V_0 = A_0 L_0$ and $V = A L$, it follows that these mass matrices are constant; hence, their inverses need only be determined once.

\subsubsection{Assemble Mass Matrices for the Septal Chords}

\subsection{Mass Matrices for a Pentagon}

For an alveolar septa represented as an irregular pentagon, its matrix of shape functions $\mathbf{N}$ takes on the form of
 \begin{equation}
	\mathbf{N} = 
	\begin{bmatrix}
	N_1 & 0 & N_2 & 0 & N_3 & 0 & N_4 & 0 & N_5 & 0 \\ 0 & N_1 & 0 & N_2 & 0 & N_3 & 0 & N_4 & 0 & N_5 
\end{bmatrix} 
	\label{shape2D}
\end{equation}
where $\mathrm{N}_i$, $i = 1, \ldots, 5$, are the five shape functions that correspond with the five vertices of a pentagon, as established in Eqn.~(\ref{shapeFunctions}).

A consistent mass matrix $\mathbf{M}_{2C}$ is constructed by substituting the above matrix of shape functions into the following expression
\begin{equation}
    \mathbf{M}_{2C} = \iint_{\pentagon} \rho \, \mathbf{N}^{\mathsf{T}} \mathbf{N} \,|\mathbf{J}| \, h \, \mathrm{d} \xi \, \mathrm{d} \eta
    \label{massintegral2d}
\end{equation}
with $h$ denoting membrane thickness, and where $|\mathbf{J}|$ denotes the determinant of a $2 \! \times \! 2$ Jacobian matrix for a pentagon.  In quadrilateral derivations, a Jacobian of two-dimensional transformations that connect the physical ${x, y}$ to natural ${\xi, \eta}$ co-ordinate systems is needed.  The components of this Jacobian matrix are calculated using derivatives of shape functions taken with respect to the local co-ordinates at the $i^{\mathrm{th}}$ vertex via
\begin{equation}
\mathbf{J} = 
\begin{bmatrix}
\partial x / \partial\xi & \partial y / \partial\xi \\
\partial x / \partial\eta & \partial y / \partial\eta 
\end{bmatrix}  
= \begin{bmatrix}
\sum\nolimits_{i=1}^5 N_{i,\xi} (\xi,\eta) \, x_i & \sum\nolimits_{i=1}^5 N_{i,\xi} (\xi,\eta) \, y_i \\
\sum\nolimits_{i=1}^5 N_{i,\eta} (\xi,\eta) \, x_i & \sum\nolimits_{i=1}^5 N_{i,\eta} (\xi,\eta) \, y_i
\end{bmatrix}
\end{equation}
where the shape function gradients $N_{i,\xi}$ and $N_{i,\eta}$ have been established in Eqn.~(\ref{shapeFunctionGradients}), with
\begin{equation}
\mathbf{J}^{-1}  = \frac{1}{|\mathbf{J}|} \,
\begin{bmatrix}
\partial y / \partial\eta & - \partial y / \partial\xi \\
- \partial x / \partial\eta & \partial x / \partial\xi
\end{bmatrix} 
\quad \text{wherein} \quad 
| \mathbf{J} | = \frac{\partial x}{\partial \xi} \frac{\partial y}{\partial \eta} - 
\frac{\partial x}{\partial \eta} \frac{\partial y}{\partial \xi}
\label{jacobianpent}
\end{equation}
providing its inverse and Jacobian determinant.  A numerical integration of Eqn.~(\ref{massintegral2d}) results in 
\begin{equation}
    \mathbf{M}_{2C} = \sum_{i=1}^{n} \rho \, \mathbf{N}^{\mathsf{T}} ( \xi_i , \eta_i ) \, \mathbf{N} ( \xi_i , \eta_i ) \,|\mathbf{J}| \, h \, w_i
\end{equation}
where $n$ stands for the number of Gauss points, and where $w_i$ and $w_j$ denote the weights of quadrature in an element's natural co-ordinate system, which can be found in Table~\ref{tabQuadrature}.

A lumped mass matrix for a pentagon gets its diagonal elements as follows
\begin{equation}
{M}_{2Li} = \sum_{j=1}^n \iint_{\pentagon} \rho \, N_i \, N_j \, |\mathbf{J}| \, h \,  \mathrm{d} \xi \, \mathrm{d} \eta =  \sum_{i=1}^n  \rho  \, N ( \xi_i , \eta_i ) \, |\mathbf{J}| \, h \, w_i
\label{LumMass2D}
\end{equation}
because $\sum_{j=1}^n N_j = 1$. 

For instance, the averaged lumped-consistent mass matrix for a pentagon with $1$ Gauss point of integration located at its centroid is constructed by averaging its consistent and lumped mass matrices resulting in
\begin{equation}
\mathbf{M}_{2A}  = \frac{\rho \, h A}{100}
\begin{bmatrix}
6 & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 1 & 0 \\
0 & 6 & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 1 \\
1 & 0 & 6 & 0 & 1 & 0 & 1 & 0 & 1 & 0 \\
0 & 1 & 0 & 6 & 0 & 1 & 0 & 1 & 0 & 1 \\
1 & 0 & 1 & 0 & 6 & 0 & 1 & 0 & 1 & 0 \\
0 & 1 & 0 & 1 & 0 & 6 & 0 & 1 & 0 & 1 \\
1 & 0 & 1 & 0 & 1 & 0 & 6 & 0 & 1 & 0 \\
0 & 1 & 0 & 1 & 0 & 1 & 0 & 6 & 0 & 1 \\
1 & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 6 & 0 \\
0 & 1 & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 6 
\end{bmatrix} 
\label{LumconsMassMatrix2D}
\end{equation}
where $h$ and $A$ are the thickness and area of the membrane.  It just so happens that, in this case, the mass matrix turns out nice.  Because septal volume $V$ is considered to be preserved, i.e., $V = V_0$ where $V_0 = h_0 A_0$ and $V = h A$, it follows that this mass matrix is constant; hence, its inverse need only be determined once.

Three mass matrices have been constructed for a pentagon based upon the three, Gauss, quadrature rules presented in Table~\ref{tabQuadrature}, which integrate polynomials of orders 1, 3 and 5 exactly, respectively. 

\subsubsection{Assemble Mass Matrices for the Alveolar Septa}


\subsection{Mass Matrices for a Tetrahedron}

A dodecahedron has 60 individual tetrahedra contained within it, whose centroid is a common vertex to all 60 of these tetrahedra. Hence, an analysis to find the mass matrix of a tetrahedron is used as the building block needed to assemble the mass matrix for an alveolar sac.

The matrix of shape functions $\mathbf{N}$ for a tetrahedon has the form of
\begin{equation}
	\mathbf{N} =  
\begin{bmatrix*}[r]
	N_1 & 0 & 0 & N_2 & 0 & 0 & N_3 & 0 & 0 & N_4 & 0 & 0 \\
	0 & N_1 & 0 & 0 & N_2 & 0 & 0 & N_3 & 0 & 0 & N_4 & 0 \\
	0 & 0 & N_1 & 0 & 0 & N_2 & 0 & 0 & N_3 & 0 & 0 & N_4
\end{bmatrix*} 
	\label{shape3D}
\end{equation}
in which $\mathrm{N}_i$, $i = 1, 2, 3, 4$, are the four shape functions corresponding to the four vertices of a tetrahedron that are defined as follows
\begin{subequations}
\begin{align}
	N_1 & = 1 - \xi - \eta - \zeta \\
	N_2 & = \xi \\
	N_3 & = \eta \\
	N_4 & = \zeta .
\end{align}
\end{subequations}
Numerical integration is used to obtain the mass matrix of a tetrahedron via
\begin{equation}
    \begin{aligned}
    \mathbf{M}_{3C} & = \iiint_V \rho \, \mathbf{N}^{\mathsf{T}} \mathbf{N} \, \mathrm{d} \mathbf{x} \, \mathrm{d} \mathbf{y} \, \mathrm{d} \mathbf{z} = \int_0^1 \int_0^1 \int_0^1 \rho \, \mathbf{N}^{\mathsf{T}} \mathbf{N} \, | \mathbf{J} | \, \mathrm{d} \mathbf{\xi} \, \mathrm{d} \mathbf{\eta} \, \mathrm{d} \mathbf{\zeta} \\ & = \sum_{i=1}^n \rho \, \mathbf{N}^{\mathsf{T}} ( \xi_i , \eta_i , \zeta_i ) \, \mathbf{N} (\xi_i , \eta_i , \zeta_i ) \,|\mathbf{J}| \, w_i
    \end{aligned}
\end{equation}
with $|\mathbf{J}|$ being the determinant of the Jacobian matrix, and $n$ denoting the number of Gauss points used for integration.  The Jacobian is calculated from derivatives of the shape functions taken with respect to its local co-ordinates $(\xi, \eta, \zeta)$ that associate with their current global co-ordinates $(x_i, y_i, z_i)$ according to
\begin{equation}
\begin{aligned}
 \mathbf{J}= &
\begin{bmatrix}
\partial x / \partial\xi & \partial y / \partial\xi & \partial z / \partial\xi\\
\partial x / \partial\eta & \partial y / \partial\eta & \partial z / \partial\eta \\
\partial x / \partial\zeta & \partial y / \partial\zeta & \partial z / \partial\zeta 
\end{bmatrix} = \begin{bmatrix} 
    x_{,\xi} & y_{,\xi} & z_{,\xi} \\
    x_{,\eta} & y_{\eta} & z_{,\eta} \\
    x_{,\zeta} & y_{,\zeta} & z_{,\zeta}
\end{bmatrix} \\
  = & \begin{bmatrix}
\sum\nolimits_{i=1}^4 N_{i,\xi} (\xi,\eta,\zeta) \, x_i & \sum\nolimits_{i=1}^4 N_{i,\xi} (\xi,\eta,\zeta) \, y_i &
\sum\nolimits_{i=1}^4 N_{i,\xi} (\xi,\eta,\zeta) \, z_i\\
\sum\nolimits_{i=1}^4 N_{i,\eta} (\xi,\eta,\zeta) \, x_i & \sum\nolimits_{i=1}^4 N_{i,\eta} (\xi,\eta,\zeta) \, y_i &
\sum\nolimits_{i=1}^4 N_{i,\eta} (\xi,\eta,\zeta) \, z_i\\
\sum\nolimits_{i=1}^4 N_{i,\zeta} (\xi,\eta,\zeta) \, x_i & \sum\nolimits_{i=1}^4 N_{i,\zeta} (\xi,\eta,\zeta) \, y_i &
\sum\nolimits_{i=1}^4 N_{i,\zeta} (\xi,\eta,\zeta) \, z_i
\end{bmatrix} 
\end{aligned}
\label{jacobiantet}
\end{equation}
with
\begin{equation}
\mathbf{J}^{-1} = \frac{1}{|\mathbf{J}|} \,
\begin{bmatrix}
y_{,\eta} \, z_{,\zeta} - z_{,\eta} \, y_{,\zeta}  & z_{,\xi} \, y_{,\zeta} - y_{,\xi} \, z_{,\zeta} & y_{,\xi} \, z_{,\eta} - y_{,\eta} \, z_{,\xi} \\
z_{,\eta} \, x_{,\zeta} - x_{,\eta} \, z_{,\zeta}  &  x_{,\xi} \, z_{,\zeta} - z_{,\xi} \, x_{,\zeta} & z_{,\xi} \, x_{,\eta} - x_{,\xi} \, z_{,\eta} \\
 x_{,\eta} \, y_{,\zeta} - y_{,\eta} \, x_{,\zeta}  & y_{,\xi} \, x_{,\zeta} - x_{,\xi} \, y_{,\zeta} & y_{,\eta} \, x_{,\xi} - y_{,\xi} \, x_{,\eta} \\
\end{bmatrix} 
\label{detjacobiantet}
\end{equation}
establishing its inverse.

For instance, the averaged lumped-consistent mass matrix for a tetrahedron with 1 Gauss point of integration located at its centroid is
\begin{equation}
\mathbf{M}_{3A} = \frac{\rho \, V}{96} \begin{bmatrix}
5 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 \\
0 & 5 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 1 & 0 \\
0 & 0 & 5 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 1 \\
1 & 0 & 0 & 5 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 \\
0 & 1 & 0 & 0 & 5 & 0 & 0 & 1 & 0 & 0 & 1 & 0 \\
0 & 0 & 1 & 0 & 0 & 5 & 0 & 0 & 1 & 0 & 0 & 1 \\
1 & 0 & 0 & 1 & 0 & 0 & 5 & 0 & 0 & 1 & 0 & 0 \\
0 & 1 & 0 & 0 & 1 & 0 & 0 & 5 & 0 & 0 & 1 & 0 \\
0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 5 & 0 & 0 & 1 \\
1 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 5 & 0 & 0 \\
0 & 1 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 5 & 0 \\
0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 5 
\end{bmatrix}
\end{equation}
where the volume $V$ varies with deformation because air is compressible.  The other cases are not as simple.

Three mass matrices for a tetrahedron are implemented based upon the three, Gauss, quadrature rules presented in Table~\ref{tabQuadraturetetra}.  These quadratures integrate polynomials of order 1, 2 and 3, respectively. 

\subsubsection{Assemble Tetrahedral Mass Matrices to Get Mass Matrix for an Alveolar Sac}


\section{Stiffness Matrix}
\label{secStiffnessMatrices}

For a nonlinear elastic material, like a soft tissue, the stress-strain response generally becomes stiffer with increasing deformation.  Consequently, the slope along their stress-strain curve changes with strain and, therefore, its instantaneous stiffness changes, too.  Therefore, tangent stiffness matrices are required for our finite element simulations. 

The total potential energy of a deformed body can be expressed as the difference between a variation in the potential energy of deformation $\delta{U}$ and a variation in the potential energy of the external loading $\delta{W}$ \cite{Yangetal10}
\begin{subequations}
    \label{principle}
\begin{align}
\delta{R} &= \delta{U} - \delta{W}\\
\intertext{with}
\delta{W} & = \mathbf{F} \, \mathrm{d} \boldsymbol{\Delta}\\
\delta{U} & = \int_{V} \, \bar{\mathbf{B}}^{\mathsf{T}} \, \mathbf{T} \, \mathrm{d} V \, \mathrm{d} \boldsymbol{\Delta}
\end{align}
\end{subequations}
where $\mathbf{F}$ is a vector of external forces, $\mathbf{T}$ are the conjugate stresses to our strains, and $\bar{\mathbf{B}}$ is a matrix relation between strain $\mathbf{E}$ and nodal displacements $\boldsymbol{\Delta}$ such that
\begin{equation}
\mathbf{E} = \bar{\mathbf{B}} \,  \boldsymbol{\Delta} \quad \text{with} \quad \mathrm{d} \mathbf{E} = \bar{\mathbf{B}} \, \mathrm{d} \boldsymbol{\Delta}
\label{strain} 
\end{equation}
with displacement fields being interpolated as
\begin{equation}
\bar{\mathbf{ u}} = 
\begin{Bmatrix}
u \\
v     
\end{Bmatrix}
=
\begin{Bmatrix}
\sum_{i=1}^{n} u_i \, N_i \\
\sum_{i=1}^{n} v_i \, N_i     
\end{Bmatrix}
= \mathbf{N} \, \boldsymbol{\Delta} .
\end{equation} 
The total strain-displacement matrix can be defined as a sum of linear and nonlinear strain displacements as follow
\begin{equation}
\bar{\mathbf{B}} = \mathbf{B}_L + \mathbf{B}_N
\label{straindis}
\end{equation} 
where $\mathbf{B}_L$ is obtained from linear analysis, i.e., $\mathbf{E}_L = \mathbf{B}_L \, \boldsymbol{\Delta}$, with $\mathbf{B}_N$ being that function of displacements $ \mathbf{u}$ which can be obtained from the nonlinear part of strain $\mathbf{E}_N$.  It can be formed as follow 
\begin{equation}
\mathbf{E}_N = \tfrac{1}{2} \, {\mathbf{A}} \,  \boldsymbol{\theta}
\end{equation}
with ${\mathbf{A}}$ being a matrix of derivatives of displacement, and $\boldsymbol{\theta}$ being a vector of derivatives of displacement that can be expressed as $\boldsymbol{\theta} = \mathbf{H} \, \boldsymbol{\Delta} $, or in rate form as $\mathrm{d} \boldsymbol{\theta} = \mathbf{H} \, \mathrm{d} \boldsymbol{\Delta}$, where $\mathbf{H}$ is the derivative of shape functions taken respect to the global co-ordinate system.  Thus, the derivative of strain takes on the form of
\begin{equation}
\mathrm{d} \mathbf{E} = \mathrm{d} (\mathbf{E}_L + \mathbf{E}_N) = \mathrm{d} \mathbf{E}_N = \tfrac{1}{2} \, (\mathrm{d} \mathbf{A} \, \boldsymbol{\theta} + \mathbf{A} \, \mathrm{d} \boldsymbol{\theta}) = \mathbf{A} \, \mathbf{H} \, \mathrm{d} \boldsymbol{\Delta} .
\label{dstrain1}
\end{equation} 
Rewriting Eqn.~(\ref{straindis}) in incremental form yields $\mathrm{d} \bar{\mathbf{B}} = \mathrm{d} (\mathbf{B}_L + \mathbf{B}_N) = \mathrm{d} \mathbf{B}_N$, where the nonlinear strain displacement and its incremental form can be obtained as follow
\begin{equation}
\mathbf{B}_N = \mathbf{A} \, \mathbf{H} \quad \text{with} \quad \mathrm{d} \mathbf{B}_N = \mathrm{d} \mathbf{A} \, \mathbf{H}
\end{equation} 
wherein $\mathrm{d} \mathbf{A} = \mathbf{A}^{'} \, \mathrm{d} \boldsymbol{\Delta} $.

In order to satisfy the equilibrium, the first variation of the total potential energy, which is known as the residual force, should be zero \cite{Elseifi98}, viz.,
\begin{equation}
\mathbf{R} = \int_{V} \, \bar{\mathbf{B}}^{\mathsf{T}} \, \mathbf{T} \, \mathrm{d} V - \mathbf{F} = 0
\label{residual}
\end{equation}
whose derivative yields
\begin{equation}
\mathrm{d} \mathbf{R} = \int_{V} \, \mathrm{d} \bar{\mathbf{B}}^{\mathsf{T}} \, \mathbf{T} \, \mathrm{d} V + \int_{V} \, \bar{\mathbf{B}}^{\mathsf{T}} \, \mathrm{d} \mathbf{T} \, \mathrm{d} V 
\label{diffresidual}
\end{equation}
where $\mathrm{d} \mathbf{T} = \mathbf{M} \, \mathrm{d} \mathbf{E} = \mathbf{M} \,  \bar{\mathbf{B}} \, \mathrm{d} \boldsymbol{\Delta}$, with $\mathbf{M}$ being the matrix of elastic tangent moduli. 

The tangent stiffness matrix can be obtained by substituting the definition of $\mathrm{d} \mathbf{T}$ into Eq.~(\ref{diffresidual}) as follow 
\begin{equation}
\begin{aligned}
\mathrm{d} \mathbf{R} & = \int_{V} \, \mathrm{d} \mathbf{B}_N^{\mathsf{T}} \, \mathbf{T} \, \mathrm{d} V + \int_{V} \, \bar{\mathbf{B}}^{\mathsf{T}} \, \mathbf{M} \, \bar{\mathbf{B}} \, \mathrm{d} V \, \mathrm{d} \boldsymbol{\Delta} \\ 
& = \int_{V} \,  (\mathbf{H}^{\mathsf{T}} \, \mathrm{d} \mathbf{A}^{\mathsf{T}} \mathbf{T}) \, \mathrm{d} V + \int_{V} \, \left(\mathbf{B}_L + \mathbf{B}_N \right)^{\mathsf{T}} \, \mathbf{M} \,  \left(\mathbf{B}_L + \mathbf{B}_N \right) \, \mathrm{d} V \, \mathrm{d} \boldsymbol{\Delta} \\ 
& = \mathbf{K}_\mathbf{S}  \, \mathrm{d} \boldsymbol{\Delta} + \int_{V} \, \mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L \, \mathrm{d} V \, \mathrm{d} \boldsymbol{\Delta}\\ 
& + \int_{V} \,  \left(\mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_N + \mathbf{B}_N^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L + \mathbf{B}_N^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_N \, \right) \, \mathrm{d} V \, \mathrm{d} \boldsymbol{\Delta}\\
& = \left(\mathbf{K}_\mathbf{S} + \mathbf{K}_L + \mathbf{K}_N\right)\mathrm{d} \boldsymbol{\Delta} = \mathbf{K}_T \, \mathrm{d} \boldsymbol{\Delta}
\end{aligned} 
\end{equation} 
wherein $\mathbf{K}_\mathbf{S}$ being the stiffness matrix associated with the initial stress, $\mathbf{K}_L$ being the conventional small displacement stiffness matrix, $\mathbf{K}_N$ being the the large displacement stiffness matrix, and $\mathbf{K}_T$ being the total tangent-stiffness matrix. 

\subsection{Stiffness Matrix for Chord}

The components of Laplace stretch $\boldsymbol{\mathcal{U}}$ have a Cholesky factorization expressed in terms of the right Cauchy-Green deformation tensor $\mathbf{C} = \mathbf{F}^{\mathsf{T}} \mathbf{F} = \boldsymbol{\mathcal{U}}^{\mathsf{T}} \boldsymbol{\mathcal{U}}$, which is a symmetric second-order tensor.  A 1-D chord has an axial strain of $e = \ln ( a / a_0 ) \equiv \ln ( L / L_0 )$ where $L$ is the length of the chord, $a$ is the 11~component of Laplace stretch that can be written in terms of the derivatives of displacement as follows
\begin{equation}
a = {\mathcal{U}}_{11} = \sqrt{C_{11}}  \quad \text{with} \quad \mathrm{C_{11}} = \left(\frac{\mathrm{\partial u}}{\partial x}\right)^2 + 2\, \frac{\mathrm{\partial u}}{\partial x}  + 1
\end{equation} 
which presumes that $a_0 = 1$.  The total axial strain of a chord can therefore be expressed in terms of linear and nonlinear strain increments as
\begin{equation}
 e = e_{L} + e_{N} 
\end{equation}
where the Taylor series of $e = \ln \sqrt{C_{11}}$ has been used to extract its linear and nonlinear parts of displacement, they being
\begin{subequations}
	\begin{align}
	e_{L} & = \mathrm{\frac{\partial u}{\partial x}} \\
	e_{N} & = -\frac{1}{2} \, \mathrm{\frac{\partial u}{\partial x}}\, \mathrm{\frac{\partial u}{\partial x}}
	\end{align}
\end{subequations}
which have been truncated after their quadratic contribution.

The linear strain-displacement matrix $\mathbf{B}_L$ can now be obtained from the derivatives of displacement as follows
\begin{subequations}
	\begin{align}
e_L  = 
\partial u / \partial x   = &
\sum\nolimits_{i=1}^2 N_{i,x} \, u_i = \begin{bmatrix}
[\mathbf{b}_{L1}], & [\mathbf{b}_{L2}]
\end{bmatrix}  \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix}  
= [\mathbf{B}_L] \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix}\\
 \intertext{with} \mathbf{b}_{Li}  & = 
N_{i,x} \quad \text{and} \quad
\mathbf{\Delta}^T  = 
\begin{Bmatrix}
u_1 ,u_2
\end{Bmatrix} 
\end{align}
\end{subequations}
where $u_1$ and $u_2$ are the displacements at the ends of the chord.  Furthermore, the nonlinear strain term can be written as 
\begin{equation}
e_ N =  \tfrac{1}{2} \,
 [-\partial u / \partial x ]
\{\partial u / \partial x\}
= \tfrac{1}{2} \, \mathbf{A} \, \boldsymbol{\theta}
\end{equation}
where the derivatives of displacement can be related to the nodal parameters via
\begin{equation}
\boldsymbol{\theta} =  \begin{Bmatrix}
\partial u / \partial x
\end{Bmatrix}
= \begin{Bmatrix}
\sum\nolimits_{i=1}^2 N_{i,x} \, u_i
\end{Bmatrix} 
= \begin{bmatrix}
[\mathbf{h}_1], & [\mathbf{h}_2]
\end{bmatrix}  \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix}  
= [\mathbf{H}] \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix} \quad \text{with} \quad \mathbf{h}_i = N_{i,x}  
\end{equation}
hence $\mathbf{B}_N$ become
\begin{equation}
\mathbf{B}_N = \mathbf{A} \, \mathbf{H}  =  \begin{bmatrix}
[\mathbf{b}_{N1}], & [\mathbf{b}_{N2}] 
\end{bmatrix} 
\end{equation}
where
\begin{equation}
\mathbf{b}_{Ni}  =   
 [-\partial u / \partial x] \cdot
N_{i,x} 
\end{equation}

The stress stiffness matrix $\mathbf{K}_\mathbf{S}$ expresses the influence of stress on the axial deflection of a chord independent of material properties, specifically
\begin{equation}
\mathbf{K}_\mathbf{S} = \int_{\Gamma} \, \mathbf{H}^{\mathsf{T}} \, \mathrm{d} \mathbf{A}^{\mathsf{T}} \mathbf{T} \, A \, \mathrm{d} x 
= \int_{-1}^{1} \mathbf{H}^{\mathsf{T}} \,  \mathbf{T} \, \mathbf{H} \, \mathbf{J}  \, A \,  \mathrm{d} \xi
 = \sum_{i=1}^{n}  \mathbf{H}^{\mathsf{T}} \, \mathbf{T} \, \mathbf{H}  \, \mathbf{J} \, A \, \mathrm{w}_i
\end{equation}
wherein $\mathbf{T}$ is the stress carried by collagen and elastin fibers, as discussed in Part~4, and $\mathbf{H}$ can be expressed as follows
\begin{equation}
\begin{aligned}
\mathbf{H} = \begin{bmatrix}
 N_{1,x} &  N_{2,x}
\end{bmatrix} = \begin{bmatrix}
 N_{1,\xi} & N_{2,\xi} \, 
\end{bmatrix} \, \mathbf{J}^{-1}
\end{aligned}
\end{equation}
where the Jacobian $\mathbf{J}$ is defined in Eqn.~\ref{detJac1D}.

The small displacement stiffness matrix for a 1-D alveolar chord that is transformed from global co-ordinate system to the natural coordiante system by the determinant of the Jacobian matrix, i.e., Eq.~(\ref{detJac1D}) is evaluated numerically as 
\begin{equation}
\mathbf{K}_{L} = \int_{\Gamma} \, \mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L \, A \, \mathrm{d} x  = \int_{-1}^{1} \mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L \, \mathbf{J}  \, A \,  \mathrm{d} \xi =  \sum_{i=1}^{n}  \mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L \, \mathbf{J} \, A \, \mathrm{w}_i
\end{equation}
with $\mathrm{w}_i$ being the  weighting coefficients of the Gauss integration rule, and $A$ being the cross section area of alveolar chord. The values of $\xi$ and $\mathrm{w}_i$ for $n = 1, 2$, and $3$ Gauss integration points are demonstrated in Table~\ref{tabQuadrature1D}.
In calculation of the stiffness matrix for an element, the linear strain-displacement matrix $\mathbf{B}_L$ is required that is the derivatives of the shape functions with respect to the global co-ordinate system  
\begin{equation}
\mathbf{B}_L = \begin{bmatrix}
 N_{1,x} &   N_{2,x}
\end{bmatrix} = \begin{bmatrix}
 N_{1,\xi} &   N_{2,\xi} \, 
\end{bmatrix} \, \mathbf{J}^{-1}
\end{equation}
wherein $\xi$ is abscissae of the Gauss integration rule. 

The large displacement stiffness matrix for chord can be presented as follow
\begin{equation}
\mathbf{K}_{N} = \int_{-1}^{1} \mathbf{D} \, \mathbf{J}  \, A \,  \mathrm{d} \xi 
= \sum_{i=1}^{n} \mathbf{D} \, \mathbf{J} \, A \, \mathrm{w}_i
\end{equation}
where $\mathbf{D}$ take the form of
\begin{equation}
\mathbf{D} = \mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_N \, + \mathbf{B}_N^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L \, + \mathbf{B}_N^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_N 
\end{equation}
wherein $\mathbf{B}_N$ have the expression 
\begin{equation}
\mathbf{B}_{N} =  \begin{bmatrix}
\partial \mathbf{u} / \partial \mathbf{x} 
\end{bmatrix} \, \begin{bmatrix}
 N_{1,x} &  N_{2,x}
\end{bmatrix} = \begin{bmatrix}
\sum\nolimits_{=1}^n N_{i,x} \, u_i
\end{bmatrix} \, \begin{bmatrix}
 N_{1,\xi} &   N_{2,\xi} \, 
\end{bmatrix} \, \mathbf{J}^{-1} 
\end{equation}
Thereby the total stiffness matrix $\mathbf{K}_T$ can be obtained by summation of stress stiffness matrix, small and large displacement stiffness matrices.

\subsection{Stiffness Matrix for Pentagon}
The components of Laplace stretch $\boldsymbol{\mathcal{U}}$ associated with a planar membrane has a  Cholesky factorization expressed in terms of the right Cauchy-Green deformation tensor $\mathbf{C} \defeq \mathbf{F}^{\mathsf{T}} \mathbf{F} = \boldsymbol{\mathcal{U}}^{\mathsf{T}} \boldsymbol{\mathcal{U}}$, which is a symmetric second-order tensor. 
\begin{equation}
\begin{aligned}
{\mathcal{U}}_{11} & = \sqrt{C_{11}} \;\; & 
{\mathcal{U}}_{12} & = C_{12} / {\mathcal{U}_{11}} \\
{\mathcal{U}}_{21} & = 0 &
{\mathcal{U}}_{22} & = \sqrt{C_{22} - ({\mathcal{U}}_{12})^2} 
\end{aligned}
\label{Laplace stretchComponents}
\end{equation} 
where ${C_{11}}$, ${C_{12}}$, ${C_{21}}$ and ${C_{22}}$ are components of the Green deformation matrix $\mathbf{C}$ wherein  $\mathbf{F}$ is the deformation gradient.
\begin{subequations}
	\begin{align}
	\mathbf{C} &= \mathbf{F}^{\mathsf{T}} \mathbf{F} =
	\begin{bmatrix}
	C_{11} & C_{12}  \\
	C_{12} & C_{22} 
	\end{bmatrix} \quad \textrm{,} \quad
	\mathbf{F} =  
	\begin{bmatrix}
	1+\mathrm{\partial u / \partial x} & \mathrm{\partial u / \partial y}  \\
	\mathrm{\partial v / \partial x} & 1+\mathrm{\partial v / \partial y}
	\end{bmatrix}\\
	\intertext{with}
	\mathrm{C_{11}}&= \left(\frac{\mathrm{\partial u}}{\partial x}\right)^2+ \left(\frac{\mathrm{\partial v}}{\partial x}\right)^2 + 2\, \frac{\mathrm{\partial u}}{\partial x}  + 1\\
	\mathrm{C_{12}}&= \frac{\mathrm{\partial u}}{\partial y} + \frac{\mathrm{\partial v}}{\partial x} + \frac{\mathrm{\partial u}}{\partial x} \cdot \frac{\mathrm{\partial u}}{\partial y} + \frac{\mathrm{\partial v}}{\partial x} \cdot \frac{\mathrm{\partial v}}{\partial y}\\
	\mathrm{C_{22}}&= \left(\frac{\mathrm{\partial u}}{\partial y}\right)^2 + \left(\frac{\mathrm{\partial v}}{\partial y}\right)^2 + 2\, \frac{\mathrm{\partial v}}{\partial y} + 1
	\end{align}
\end{subequations}
It is useful to define the total virtual strains Eq.~(\ref{conjugateStrains}) in terms of linear and nonlinear incremental strains as follow
\begin{subequations}
	\begin{align}
	\mathrm  \xi & = \mathrm \xi_{L} + \mathrm  \xi_{N1} + \mathrm  \xi_{N2}\\
	\mathrm  \varepsilon & = \mathrm  \varepsilon_{L} + \mathrm  \varepsilon_{N1} + \mathrm  \varepsilon_{N2}\\
	\mathrm \gamma & = \mathrm  \gamma_{L} + \mathrm  \gamma_{N1} + \mathrm  \gamma_{N2}
	\end{align}
	\label{totalvirtualstrain}
\end{subequations}
Taylor series are used here to obtain the linear and nonlinear part of displacements 
\begin{subequations}
	\begin{align}
	\mathrm \xi_{L} & = \frac{1}{2} \, \left(\mathrm{\frac{\partial u}{\partial x}} + \mathrm{\frac{\partial v}{\partial y}}\right)\\
	\mathrm \xi_{N} & = \frac{1}{4} \, \left(- \mathrm{\frac{ \partial v}{\partial y}}\, \mathrm{\frac{ \partial v}{\partial y}} -\mathrm{\frac{\partial u}{\partial x}}\, \mathrm{\frac{\partial u}{\partial x}} - 2 \, \mathrm{\frac{\partial u}{\partial y}}\, \mathrm{\frac{\partial v}{\partial x}}\right)\\
	\mathrm \varepsilon_{L} & = \frac{1}{2} \, \left(\mathrm{\frac{\partial u}{\partial x}} - \mathrm{\frac{\partial v}{\partial y}}\right)\\
	\mathrm \varepsilon_{N} & = \frac{1}{4} \, \left(2 \, \mathrm{\frac{\partial v}{\partial x}}\, \mathrm{\frac{\partial v}{\partial x}} + \mathrm{\frac{ \partial v}{\partial y}}\, \mathrm{\frac{ \partial v}{\partial y}} -\mathrm{\frac{\partial u}{\partial x}}\, \mathrm{\frac{\partial u}{\partial x}} + 2 \, \mathrm{\frac{\partial u}{\partial y}}\, \mathrm{\frac{\partial v}{\partial x}}\right)\\
	\mathrm \gamma_{L} & = \mathrm{\frac{\partial u}{\partial y}} + \mathrm{\frac{\partial v}{\partial x}}\\
	\mathrm \gamma_{N} & = \mathrm{\frac{\partial v}{\partial x}}\, \mathrm{\frac{\partial v}{\partial y}} - 2\, \mathrm{\frac{ \partial u}{\partial x}}\, \mathrm{\frac{ \partial v}{\partial x}} 
	-\mathrm{\frac{\partial u}{\partial x}}\, \mathrm{\frac{\partial u}{\partial y}}
	\end{align}
\end{subequations}
The linear strain displacement matrix $\mathbf{B}_L$ can be obtained by differentiation of displacements expressed through the nodal displacements and shape functions from infinitesimal linear strain vector that take the form of
\begin{equation}
\begin{aligned}
\mathbf{E}_L & =  \begin{Bmatrix}
\mathrm \xi_{L} \\
\mathrm \varepsilon_{L} \\
\mathrm \gamma_{L} \end{Bmatrix} = 
\begin{Bmatrix}
\tfrac{1}{2} \, u_{,x} +   \tfrac{1}{2} \, v_{,y} \\
\tfrac{1}{2} \, u_{,x} - \tfrac{1}{2} \, v_{,y} \\
u_{,y} + v_{,x} \end{Bmatrix} = \begin{bmatrix}
\tfrac{1}{2} \, \sum\nolimits_{i=1}^5 N_{i,x}  & \tfrac{1}{2} \, \sum\nolimits_{i=1}^5 N_{i,y}  \\
\tfrac{1}{2} \, \sum\nolimits_{i=1}^5 N_{i,x}  & -\tfrac{1}{2} \, \sum\nolimits_{i=1}^5 N_{i,y}  \\ \sum\nolimits_{i=1}^5 N_{i,y}  & \sum\nolimits_{i=1}^5 N_{i,x}  \end{bmatrix} \, \begin{Bmatrix}
u_{i} \\
v_{i} \end{Bmatrix} \\
& = \begin{bmatrix}
[\mathbf{b}_{L1}], & [\mathbf{b}_{L2}], & [\mathbf{b}_{L3}], & [\mathbf{b}_{L4}], & [\mathbf{b}_{L5}] 
\end{bmatrix}  \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix}  
= [\mathbf{B}_L] \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix} 
\end{aligned}
\end{equation}
wherein 
\begin{subequations}
\begin{align}
\mathbf{b}_{Li} = & \begin{bmatrix}
\tfrac{1}{2} \, N_{i,x}  &  \tfrac{1}{2} \, N_{i,y} \\
\tfrac{1}{2} \, N_{i,x}  & - \tfrac{1}{2} \, N_{i,y} \\
N_{i,y} & N_{i,x}  \end{bmatrix}\\
\intertext{and}
\mathbf{\Delta}^T  = &
\begin{Bmatrix}
u_1, v_1, u_2, v_2, ...,u_n, v_n
\end{Bmatrix}
\end{align}
\end{subequations}
The first nonlinear strain terms can be written as 
\begin{equation}
\begin{aligned}
\mathbf{E}_{N1} & =  \begin{Bmatrix}
\mathrm \xi_{N1} \\
\mathrm \varepsilon_{N1} \\
\mathrm \gamma_{N1} \end{Bmatrix} =
 \begin{Bmatrix}
-\tfrac{1}{4} \, u_{,x}^2 -   \tfrac{1}{4} \, v_{,y}^2 \\
-\tfrac{1}{4} \, u_{,x}^2 + \tfrac{1}{4} \, v_{,y}^2 \\
-u_{,y} \, u_{,x} + v_{,x} \, v_{,y} \end{Bmatrix} = \frac{1}{2} \, \begin{bmatrix}
-\tfrac{1}{2} \, \partial u / \partial x &  - \tfrac{1}{2} \, \partial v / \partial y \\
-\tfrac{1}{2} \, \partial u / \partial x &  \tfrac{1}{2} \, \partial v / \partial y \\
-2 \, \partial u / \partial y  & 2 \, \partial v / \partial x  \end{bmatrix} \, \begin{Bmatrix}
\partial u / \partial x\\
\partial v / \partial y
\end{Bmatrix}
= \tfrac{1}{2} \, [\mathbf{A}_{N1}] \, [\boldsymbol{\theta}_{N1}]
\end{aligned}
\end{equation}
the derivative of displacement can be related to the nodal parameters via
\begin{equation}
[\boldsymbol{\theta}_{N1}] =  \begin{Bmatrix}
\partial u / \partial x\\
\partial v / \partial y
\end{Bmatrix}
= \begin{Bmatrix}
\sum\nolimits_{i=1}^5 N_{i,x} \, u_i\\
\sum\nolimits_{i=1}^5 N_{i,y} \, v_i
\end{Bmatrix} 
= \begin{bmatrix}
[\mathbf{h}_{N1}], & [\mathbf{h}_{N2}], & [\mathbf{h}_{N3}], & [\mathbf{h}_{N4}], & [\mathbf{h}_{N5}] 
\end{bmatrix}  \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix}  
= [\mathbf{H}_{N1}] \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix} 
\end{equation}
where 
\begin{equation}
\mathbf{h}_{Ni} = \begin{bmatrix}
N_{i,x} &  0  \\
0 & N_{i,y}  \end{bmatrix} 
\end{equation}
hence $\mathbf{B}_{N1}$ become
\begin{equation}
\mathbf{B}_{N1} = [\mathbf{A}_{N1}] \, [\mathbf{H}_{N1}] = \begin{bmatrix}
 [\mathbf{b}_{N1}], & [\mathbf{b}_{N2}], & [\mathbf{b}_{N3}], & [\mathbf{b}_{N4}], & [\mathbf{b}_{N5}] 
\end{bmatrix} 
\end{equation}
where
\begin{equation}
\mathbf{b}_{Ni} = \begin{bmatrix}
-\tfrac{1}{2} \, \partial u / \partial x &  - \tfrac{1}{2} \, \partial v / \partial y \\
-\tfrac{1}{2} \, \partial u / \partial x &  \tfrac{1}{2} \, \partial v / \partial y \\
-2 \, \partial u / \partial y  & 2 \, \partial v / \partial x  \end{bmatrix}  \, \begin{bmatrix}
N_{i,x} &  0  \\
0 & N_{i,y}  \end{bmatrix} 
\end{equation}
The second nonlinear strain terms can be written as 
\begin{equation}
\begin{aligned}
\mathbf{E}_{N2} & =  \begin{Bmatrix}
\mathrm \xi_{N2} \\
\mathrm \varepsilon_{N2} \\
\mathrm \gamma_{N2} \end{Bmatrix} =
 \begin{Bmatrix}
-\tfrac{1}{2} \, u_{,y} \, v_{,x}  \\
\tfrac{1}{2} \, u_{,y} \, v_{,x}  + \tfrac{1}{2} \, v_{,x}^2 \\
-2 \, u_{,x} \, v_{,x} \end{Bmatrix} = \frac{1}{2} \, \begin{bmatrix}
- \partial v / \partial x &  0 \\
 \partial v / \partial x &  \partial v / \partial x \\
0 & -4 \, \partial u / \partial x  \end{bmatrix} \, \begin{Bmatrix}
\partial u / \partial y\\
\partial v / \partial x
\end{Bmatrix}
= \tfrac{1}{2} \, [\mathbf{A}_{N2}] \, [\boldsymbol{\theta}_{N2}]
\end{aligned}
\end{equation}
the derivative of displacement can be related to the nodal parameters via
\begin{equation}
[\boldsymbol{\theta}_{N2}] =  \begin{Bmatrix}
\partial u / \partial y\\
\partial v / \partial x
\end{Bmatrix}
= \begin{Bmatrix}
\sum\nolimits_{i=1}^5 N_{i,y} \, u_i\\
\sum\nolimits_{i=1}^5 N_{i,x} \, v_i
\end{Bmatrix} 
= \begin{bmatrix}
[\mathbf{h}_{N1}], & [\mathbf{h}_{N2}], & [\mathbf{h}_{N3}], & [\mathbf{h}_{N4}], & [\mathbf{h}_{N5}] 
\end{bmatrix}  \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix}  
= [\mathbf{H}_2] \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix} 
\end{equation}
where 
\begin{equation}
\mathbf{h}_{Ni} = \begin{bmatrix}
N_{i,y} &  0  \\
0 & N_{i,x}  \end{bmatrix} 
\end{equation}
hence $\mathbf{B}_{N2}$ become
\begin{equation}
\mathbf{B}_{N2} = [\mathbf{A}_{N2}] \, [\mathbf{H}_{N2}] = \begin{bmatrix}
[\mathbf{b}_{N1}], & [\mathbf{b}_{N2}], & [\mathbf{b}_{N3}], & [\mathbf{b}_{N4}], & [\mathbf{b}_{N5}] 
\end{bmatrix} 
\end{equation}
where
\begin{equation}
\mathbf{b}_{Ni} = \begin{bmatrix}
- \partial v / \partial x &  0 \\
\partial v / \partial x &  \partial v / \partial x \\
0 & -4 \, \partial u / \partial x  \end{bmatrix} \, \begin{bmatrix}
N_{i,y} &  0  \\
0 & N_{i,x}  \end{bmatrix} 
\end{equation}
In order to be able to evaluate the nonlinear stiffness matrix, $[\mathbf{\bar{B}}]$ should be established as the summation of $ \mathbf{B}_{N1}$ and $\mathbf{B}_{N2}$.
Hence, the stress stiffness matrix for a 2-D alveolar septa take the form of
\begin{equation}
\mathbf{K}_\mathbf{S} = \int_{\pentagon} \int_{\pentagon}  \mathrm{d} \mathbf{B}_N^{\mathsf{T}} \, \mathbf{T} \, |\mathbf{J}|  \, h \,  \mathrm{d} \xi \,  \mathrm{d} \eta =  \sum_{i=1}^{n}  \sum_{j=1}^{n}  \mathrm{d} \mathbf{B}_N^{\mathsf{T}} \, \mathbf{T} \, |\mathbf{J}| \, h \, \mathrm{w}_i \mathrm{w}_j
\label{stressstif}
\end{equation}
where $n$ stands for number of Gauss points, $\mathrm{w}_i$ and $\mathrm{w}_j$ denote the natural weight of the element demonstrated in Table~\ref{tabQuadrature}
By taking the variation of Eq.~(\ref{straindis}) and substituting the definition of first and second nonlinear strain displacement matrices, the total nonlinear strain displacement matrix becomes
\begin{equation}
\mathrm{d}[\mathbf{B}_N]^{\mathsf{T}} = [\mathbf{H}_{N1}^{\mathsf{T}}] \mathrm{d} [\mathbf{A}_{N1}^{\mathsf{T}}] + [\mathbf{H}_{N2}^{\mathsf{T}}] \mathrm{d} [\mathbf{A}_{N2}^{\mathsf{T}}] 
\end{equation}
which on substituting into Eq.~(\ref{stressstif}) gives 
\begin{equation}
\mathbf{K_\mathbf{S}} \mathrm{d} \boldsymbol{\Delta} = \int_A \left(
[\mathbf{H}_1^{\mathsf{T}}] \mathrm{d} [\mathbf{A}_1^{\mathsf{T}}] + [\mathbf{H}_2^{\mathsf{T}}] \mathrm{d} [\mathbf{A}_2^{\mathsf{T}}]\right) \, \begin{Bmatrix} s^{\pi} \\ s^{\sigma} \\  s^{\tau} \end{Bmatrix} \, \mathrm{d} A
\end{equation}
However, using the mathematical properties of the matrix $\mathbf{A}$, the following expression will appear
\begin{equation}
\mathrm{d} [\mathbf{A}_1^{\mathsf{T}}] \, \begin{Bmatrix} s^{\pi} \\ s^{\sigma} \\  s^{\tau} \end{Bmatrix} = \begin{bmatrix}s^{\pi} & s^{\tau} \\ 
s^{\tau} & s^{\sigma} \end{bmatrix} \, [\mathbf{H}_1] \, \mathrm{d} \boldsymbol{\Delta} \quad \text{and} \quad \mathrm{d} [\mathbf{A}_2^{\mathsf{T}}] \, \begin{Bmatrix} s^{\pi} \\ s^{\sigma} \\  s^{\tau} \end{Bmatrix} = \begin{bmatrix} s^{\pi} & s^{\tau} \\ 
s^{\tau} & s^{\sigma} \end{bmatrix} \, [\mathbf{H}_2] \, \mathrm{d} \boldsymbol{\Delta}
\end{equation}
and finally the stress/geometric stiffness matrix can be expressed as follow
\begin{equation}
\begin{aligned}
\mathbf{K_{\mathbf{S}}} & =  \int_A \, [\mathbf{H}_1]^{\mathsf{T}}  \begin{bmatrix} s^{\pi} & s^{\tau} \\ 
s^{\tau} & s^{\sigma}
\end{bmatrix} \, [\mathbf{H}_1] \, \mathrm{d} A + \int_A \, [\mathbf{H}_2]^{\mathsf{T}}  \begin{bmatrix} s^{\pi} & s^{\tau} \\ 
s^{\tau} & s^{\sigma} 
\end{bmatrix} \, [\mathbf{H}_2] \, \mathrm{d} A\\
& =  \sum_{i=1}^{n} \sum_{j=1}^{n} \left( [\mathbf{H}_1]^{\mathsf{T}}  \begin{bmatrix} s^{\pi} & s^{\tau} \\ 
s^{\tau} & s^{\sigma}
\end{bmatrix} \, [\mathbf{H}_1] \, |\mathbf{J}| \, h  + [\mathbf{H}_2]^{\mathsf{T}}  \begin{bmatrix} s^{\pi} & s^{\tau} \\ 
s^{\tau} & s^{\sigma}
\end{bmatrix} \, [\mathbf{H}_2] \, |\mathbf{J}| \, h \right) \,  w_i \, w_j
\end{aligned}
\end{equation}
The small/linear displacement stiffness matrix for pentagon is evaluated numerically as 
\begin{equation}
\mathbf{K}_{L} = \int_{\pentagon} \int_{\pentagon} \mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L \, |\mathbf{J}| \, h \,  \mathrm{d} \xi \,  \mathrm{d} \eta =  \sum_{i=1}^{n} \sum_{j=1}^{n} \mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L \, |\mathbf{J}|  \, h \, \mathrm{w}_i \mathrm{w}_j
\end{equation}
The large/nonlinear displacement stiffness matrix for chord can be presented as follow
\begin{equation}
\mathbf{K}_{N} = \int_{\pentagon} \int_{\pentagon} \mathbf{D} \, |\mathbf{J}|\, h \, \mathrm{d} \xi \, \mathrm{d} \eta 
= \sum_{i=1}^{n} \sum_{j=1}^{n} \mathbf{D} \, |\mathbf{J}| \, h \, \mathrm{w}_i \mathrm{w}_j
\end{equation}
where $\mathbf{D}$ have the expression 
\begin{equation}
\mathbf{D} = \mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_N \, + \mathbf{B}_N^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L \, + \mathbf{B}_N^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_N
\end{equation}


\subsection{Stiffness Matrix for a tetrahedron}
The Laplace stretch associated with a alveolar volume has geometric interpretations that one can assign \cite{FreedSrinivasa15}
\begin{subequations}
	\label{LagrangianPhysicalStretch}
	\begin{align}
	\mathcal{U}_{ij} & = \begin{bmatrix}
	a & a \gamma & a \beta \\
	0 & b & b \alpha \\
	0 & 0 & c \end{bmatrix} 
	\end{align}
\end{subequations}
The components of Laplace stretch $\boldsymbol{\mathcal{U}}$ has a  Cholesky factorization expressed in terms of the right Cauchy-Green deformation tensor $\mathbf{C} \defeq \mathbf{F}^{\mathsf{T}} \mathbf{F} = \boldsymbol{\mathcal{U}}^{\mathsf{T}} \boldsymbol{\mathcal{U}}$, which is a symmetric second-order tensor. 
\begin{equation}
\begin{aligned}
\mathcal{U}_{11} & = \sqrt{C_{11}} & 
\mathcal{U}_{12} & = C_{12} / \mathcal{U}_{11} &
\mathcal{U}_{13} & = C_{13} / \mathcal{U}_{11} \\
\mathcal{U}_{21} & = 0 &
\mathcal{U}_{22} & = \sqrt{C_{22} - \mathcal{U}_{12}^{\,2}} &
\mathcal{U}_{23} & = \bigl( C_{23} - \mathcal{U}_{12\,}\mathcal{U}_{13} \bigr) / \mathcal{U}_{22} \\
\mathcal{U}_{31} & = 0 &
\mathcal{U}_{32} & = 0 & 
\mathcal{U}_{33} & = \sqrt{C_{33} - \mathcal{U}_{13}^{\,2} - \mathcal{U}_{23}^{\,2}}
\end{aligned}
\label{LagrangianLaplaceStretch}
\end{equation}
where ${C_{11}}$, ${C_{12}}$, ${C_{21}}$ and ${C_{22}}$ are components of the Green deformation matrix $\mathbf{C}$ wherein  $\mathbf{F}$ is the deformation gradient.
\begin{subequations}
	\begin{align}
	\mathbf{C} &= \mathbf{F}^{\mathsf{T}} \mathbf{F} =
	\begin{bmatrix}
	C_{11} & C_{12} & C_{13} \\
	C_{21} & C_{22} & C_{23} \\
	C_{31} & C_{32} & C_{33}
	\end{bmatrix} \quad \textrm{,} \quad
	\mathbf{F} =  
	\begin{bmatrix}
	1 + \mathrm{\partial u / \partial x} & \mathrm{\partial u / \partial y} & \mathrm{\partial u / \partial z} \\
	\mathrm{\partial v / \partial x} & 1 + \mathrm{\partial v / \partial y} & \mathrm{\partial v / \partial z} \\
	\mathrm{\partial w / \partial x} & \mathrm{\partial w / \partial y} & 1 + \mathrm{\partial w / \partial z}
	\end{bmatrix}\\
	\intertext{with}
	\mathrm{C_{11}} & = \left(\frac{\mathrm{\partial u}}{\partial x}\right)^2 + \left(\frac{\mathrm{\partial v}}{\partial x}\right)^2 + \left(\frac{\mathrm{\partial w}}{\partial x}\right)^2 + 2\, \frac{\mathrm{\partial u}}{\partial x}  + 1\\
	\mathrm{C_{22}} & = \left(\frac{\mathrm{\partial u}}{\partial y}\right)^2 + \left(\frac{\mathrm{\partial v}}{\partial y}\right)^2 + \left(\frac{\mathrm{\partial w}}{\partial y}\right)^2 + 2\, \frac{\mathrm{\partial v}}{\partial y} + 1\\
	\mathrm{C_{33}} & = \left(\frac{\mathrm{\partial u}}{\partial z}\right)^2 + \left(\frac{\mathrm{\partial v}}{\partial z}\right)^2 + \left(\frac{\mathrm{\partial w}}{\partial z}\right)^2 + 2\, \frac{\mathrm{\partial w}}{\partial z} + 1 \\
	\mathrm{C_{12}} & = \mathrm{C_{21}} = \frac{\mathrm{\partial u}}{\partial y} + \frac{\mathrm{\partial v}}{\partial x} + \frac{\mathrm{\partial u}}{\partial x} \cdot \frac{\mathrm{\partial u}}{\partial y} + \frac{\mathrm{\partial v}}{\partial x} \cdot \frac{\mathrm{\partial v}}{\partial y} + \frac{\mathrm{\partial w}}{\partial x} \cdot \frac{\mathrm{\partial w}}{\partial y}\\
    \mathrm{C_{13}} & = \mathrm{C_{31}} = \frac{\mathrm{\partial u}}{\partial z} + \frac{\mathrm{\partial w}}{\partial x} + \frac{\mathrm{\partial u}}{\partial x} \cdot \frac{\mathrm{\partial u}}{\partial z} + \frac{\mathrm{\partial v}}{\partial x} \cdot \frac{\mathrm{\partial v}}{\partial z} + \frac{\mathrm{\partial w}}{\partial x} \cdot \frac{\mathrm{\partial w}}{\partial z} \\
    \mathrm{C_{23}} & = \mathrm{C_{32}} = \frac{\mathrm{\partial v}}{\partial z} + \frac{\mathrm{\partial w}}{\partial y} + \frac{\mathrm{\partial u}}{\partial y} \cdot \frac{\mathrm{\partial u}}{\partial z} + \frac{\mathrm{\partial v}}{\partial y} \cdot \frac{\mathrm{\partial v}}{\partial z} + \frac{\mathrm{\partial w}}{\partial y} \cdot \frac{\mathrm{\partial w}}{\partial z}
	\end{align}
\end{subequations}
the dilatation $\delta$ for the alveolar volume is 
\begin{subequations}
	\begin{align}
	 \mathrm  \xi & \defeq \ln \sqrt[3]{\frac{a}{a_0}
		\frac{b}{b_0} \frac{c}{c_0}} \\
	\intertext{and the squeezes $\varepsilon_i$ and the shear strains $\gamma_i$ are defined accordingly}
	\varepsilon_1 & \defeq \ln \sqrt[3]{\frac{a}
		{a_0} \frac{b_0}{b}} & 	\gamma_1 & \defeq \alpha - \alpha_0 \\
	\varepsilon_2 & \defeq \ln \sqrt[3]{\frac{b}
		{b_0} \frac{c_0}{c}} & \gamma_2 & \defeq \beta - \beta_0 \\
	\varepsilon_3 & \defeq \ln \sqrt[3]{\frac{c}
		{c_0} \frac{a_0}{a}} & 	\gamma_3 & \defeq \gamma - \gamma_0 
	\end{align}
\end{subequations}
wherein $a_0$, $b_0$ and $c_0$ are their initial elongation ratios, and where $\alpha_0$, $\beta_0$ and $\gamma_0$ are their initial shears.
It is useful to define the above strains in terms of linear and nonlinear incremental strains as follow
\begin{subequations}
	\begin{align}
	\mathrm  \xi & = \mathrm \xi_{L} + \mathrm  \xi_{N1} + \mathrm  \xi_{N2} + \mathrm  \xi_{N3}\\
	\mathrm  \varepsilon_{i} & = \mathrm  \varepsilon_{iL} + \mathrm  \varepsilon_{iN1} + \mathrm  \varepsilon_{iN2} + \mathrm  \varepsilon_{iN3} \\
	\mathrm \gamma_{i} & = \mathrm  \gamma_{iL} + \mathrm  \gamma_{iN1} + \mathrm  \gamma_{iN2} + \mathrm  \gamma_{iN3}
	\end{align}
	\label{totalvirtualstrain}
\end{subequations}
Taylor series are used here to obtain the linear and nonlinear part of displacements 
\begin{subequations}
	\begin{align}
	\mathrm \xi_{L} & = \frac{1}{3} \, \left(\mathrm{\frac{\partial u}{\partial x}} + \mathrm{\frac{\partial v}{\partial y}} + \mathrm{\frac{\partial w}{\partial z}}\right)\\
	\mathrm \xi_{N} & = \frac{1}{6} \, \Big(-\mathrm{\frac{\partial u}{\partial x}}\, \mathrm{\frac{\partial u}{\partial x}} + \mathrm{\frac{\partial u}{\partial z}}\, \mathrm{\frac{\partial u}{\partial z}}  - \mathrm{\frac{ \partial v}{\partial y}}\, \mathrm{\frac{ \partial v}{\partial y}} - \mathrm{\frac{\partial v}{\partial z}}\, \mathrm{\frac{\partial v}{\partial z}} + \mathrm{\frac{\partial w}{\partial x}}\, \mathrm{\frac{\partial w}{\partial x}} - \mathrm{\frac{\partial w}{\partial y}}\, \mathrm{\frac{\partial w}{\partial y}} - \mathrm{\frac{\partial w}{\partial z}}\, \mathrm{\frac{\partial w}{\partial z}} 
    \notag \\
    \mbox{} &  - 2 \, \mathrm{\frac{\partial u}{\partial y}}\, \mathrm{\frac{\partial v}{\partial x}} - 4 \, \mathrm{\frac{\partial v}{\partial z}}\, \mathrm{\frac{\partial w}{\partial y}} \Big)\\
	\mathrm \varepsilon_{1L} & = \frac{1}{3} \, \left(\mathrm{\frac{\partial u}{\partial x}} - \mathrm{\frac{\partial v}{\partial y}}\right)\\
	\mathrm \varepsilon_{1N} & = \frac{1}{6} \, \left(2 \, \mathrm{\frac{\partial v}{\partial x}}\, \mathrm{\frac{\partial v}{\partial x}} + \mathrm{\frac{ \partial v}{\partial y}}\, \mathrm{\frac{ \partial v}{\partial y}} - \mathrm{\frac{\partial u}{\partial x}}\, \mathrm{\frac{\partial u}{\partial x}} +  \mathrm{\frac{\partial w}{\partial x}}\, \mathrm{\frac{\partial w}{\partial x}} -  \mathrm{\frac{\partial w}{\partial y}}\, \mathrm{\frac{\partial w}{\partial y}} + 2 \, \mathrm{\frac{\partial u}{\partial y}}\, \mathrm{\frac{\partial v}{\partial x}}\right)\\
	\mathrm \varepsilon_{2L} & = \frac{1}{3} \, \left(\mathrm{\frac{\partial v}{\partial y}} - \mathrm{\frac{\partial w}{\partial z}}\right)\\
	\mathrm \varepsilon_{2N} & = \frac{1}{6} \, \Big(- \mathrm{\frac{\partial v}{\partial x}}\, \mathrm{\frac{\partial v}{\partial x}} - \mathrm{\frac{ \partial v}{\partial y}}\, \mathrm{\frac{ \partial v}{\partial y}} - \mathrm{\frac{\partial u}{\partial z}}\, \mathrm{\frac{\partial u}{\partial z}} + \mathrm{\frac{\partial v}{\partial z}}\, \mathrm{\frac{\partial v}{\partial z}} + 3 \,  \mathrm{\frac{\partial w}{\partial y}}\, \mathrm{\frac{\partial w}{\partial y}} +  \mathrm{\frac{\partial w}{\partial z}}\, \mathrm{\frac{\partial w}{\partial z}}  \notag \\
	\mbox{} & - 2 \, \mathrm{\frac{\partial u}{\partial y}}\, \mathrm{\frac{\partial v}{\partial x}} + 4 \, \mathrm{\frac{\partial v}{\partial z}}\, \mathrm{\frac{\partial w}{\partial y}}\Big)\\
	\mathrm \varepsilon_{3L} & = \frac{1}{3} \, \left(-\mathrm{\frac{\partial u}{\partial x}} + \mathrm{\frac{\partial w}{\partial z}}\right)\\
	\mathrm \varepsilon_{3N} & = \frac{1}{6} \, \Big(- \mathrm{\frac{\partial v}{\partial x}}\, \mathrm{\frac{\partial v}{\partial x}} + \mathrm{\frac{ \partial u}{\partial x}}\, \mathrm{\frac{ \partial u}{\partial x}} + \mathrm{\frac{\partial u}{\partial z}}\, \mathrm{\frac{\partial u}{\partial z}} - \mathrm{\frac{\partial v}{\partial z}}\, \mathrm{\frac{\partial v}{\partial z}} - \mathrm{\frac{\partial w}{\partial x}}\, \mathrm{\frac{\partial w}{\partial x}} - 2 \,  \mathrm{\frac{\partial w}{\partial y}}\, \mathrm{\frac{\partial w}{\partial y}} \notag \\
	\mbox{} & -  \mathrm{\frac{\partial w}{\partial z}}\, \mathrm{\frac{\partial w}{\partial z}} - 4 \, \mathrm{\frac{\partial v}{\partial z}}\, \mathrm{\frac{\partial w}{\partial y}}\Big)\\
		\mathrm \gamma_{1L} & = \mathrm{\frac{\partial v}{\partial z}} + \mathrm{\frac{\partial w}{\partial y}}\\
	\mathrm \gamma_{1N} & = 2 \, \mathrm{\frac{\partial u}{\partial x}}\, \mathrm{\frac{\partial v}{\partial z}} - \mathrm{\frac{ \partial u}{\partial z}}\, \mathrm{\frac{ \partial v}{\partial x}} + 2 \, \mathrm{\frac{\partial u}{\partial x}}\, \mathrm{\frac{\partial w}{\partial y}} - \mathrm{\frac{\partial u}{\partial y}}\, \mathrm{\frac{\partial w}{\partial x}} - \mathrm{\frac{\partial v}{\partial y}}\, \mathrm{\frac{\partial v}{\partial z}} -   \mathrm{\frac{\partial v}{\partial x}}\, \mathrm{\frac{\partial w}{\partial x}} \notag \\
	\mbox{} & - 2 \, \mathrm{\frac{\partial v}{\partial y}}\, \mathrm{\frac{\partial w}{\partial y}} + \mathrm{\frac{\partial w}{\partial y}}\, \mathrm{\frac{\partial w}{\partial z}}\\
	\mathrm \gamma_{2L} & = \mathrm{\frac{\partial v}{\partial z}} + \mathrm{\frac{\partial w}{\partial y}}\\
    \mathrm \gamma_{2N} & = \mathrm{\frac{\partial u}{\partial y}}\, \mathrm{\frac{\partial u}{\partial z}} - 2 \, \mathrm{\frac{ \partial u}{\partial x}}\, \mathrm{\frac{ \partial v}{\partial z}} - 2 \, \mathrm{\frac{\partial u}{\partial x}}\, \mathrm{\frac{\partial w}{\partial y}} + \mathrm{\frac{\partial v}{\partial y}}\, \mathrm{\frac{\partial v}{\partial z}} + \mathrm{\frac{\partial w}{\partial y}}\, \mathrm{\frac{\partial w}{\partial z}}\\
    \mathrm \gamma_{3L} & = \mathrm{\frac{\partial u}{\partial y}} + \mathrm{\frac{\partial v}{\partial x}}\\
    \mathrm \gamma_{3N} & = - \mathrm{\frac{\partial u}{\partial x}}\, \mathrm{\frac{\partial u}{\partial y}} - 2 \, \mathrm{\frac{ \partial u}{\partial x}}\, \mathrm{\frac{ \partial v}{\partial x}} + \mathrm{\frac{\partial v}{\partial x}}\, \mathrm{\frac{\partial v}{\partial y}} + \mathrm{\frac{\partial w}{\partial x}}\, \mathrm{\frac{\partial w}{\partial y}} 
	\end{align}
\end{subequations}
The linear strain displacement matrix $\mathbf{B}_L$ can be obtained by differentiation of displacements expressed through the nodal displacements and shape functions from infinitesimal linear strain vector that take the form of
\begin{equation}
\begin{aligned}
\mathbf{E}_L & =  \begin{Bmatrix}
\mathrm \xi_{L} \\
\mathrm \varepsilon_{1L} \\
\mathrm \varepsilon_{2L} \\
\mathrm \varepsilon_{3L} \\
\mathrm \gamma_{1L} \\
\mathrm \gamma_{2L} \\
\mathrm \gamma_{3L}\end{Bmatrix} = 
\begin{Bmatrix}
\tfrac{1}{3} \, u_{,x} + \tfrac{1}{3} \, v_{,y} + \tfrac{1}{3} \, w_{,z} \\
\tfrac{1}{3} \, u_{,x} - \tfrac{1}{3} \, v_{,y} \\
\tfrac{1}{3} \, v_{,y} - \tfrac{1}{3} \, w_{,z} \\
- \tfrac{1}{3} \, u_{,x} + \tfrac{1}{3} \, w_{,z} \\ 
v_{,z} +  w_{,y} \\ 
v_{,z} +  w_{,y} \\ 
u_{,y} +  v_{,x} \\\end{Bmatrix} = \begin{bmatrix}
\tfrac{1}{3} \, \sum\nolimits_{i=1}^4 N_{i,x}  & \tfrac{1}{3} \, \sum\nolimits_{i=1}^4 N_{i,y} & \tfrac{1}{3} \, \sum\nolimits_{i=1}^4 N_{i,z} \\
\tfrac{1}{3} \, \sum\nolimits_{i=1}^4 N_{i,x}  & \tfrac{-1}{3} \, \sum\nolimits_{i=1}^4 N_{i,y} & 0 \\ 0 & \tfrac{1}{3} \, \sum\nolimits_{i=1}^4 N_{i,y}  &  \tfrac{-1}{3} \, \sum\nolimits_{i=1}^4 N_{i,z} \\  \tfrac{-1}{3} \, \sum\nolimits_{i=1}^4 N_{i,x}  & 0 & \tfrac{1}{3} \, \sum\nolimits_{i=1}^4 N_{i,z} \\ 0 & \sum\nolimits_{i=1}^4 N_{i,z}  &  \sum\nolimits_{i=1}^4 N_{i,y} \\ 0 & \sum\nolimits_{i=1}^4 N_{i,z}  &  \sum\nolimits_{i=1}^4 N_{i,y} \\ \sum\nolimits_{i=1}^4 N_{i,y}  &  \sum\nolimits_{i=1}^4 N_{i,x} & 0 \end{bmatrix} \, \begin{Bmatrix}
u_{i} \\
v_{i} \\
w_{i} \end{Bmatrix} \\
& = \begin{bmatrix}
[\mathbf{b}_{L1}], & [\mathbf{b}_{L2}], & [\mathbf{b}_{L3}], & [\mathbf{b}_{L4}]
\end{bmatrix}  \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix}  
= [\mathbf{B}_L] \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix} 
\end{aligned}
\end{equation}
wherein 
\begin{subequations}
	\begin{align}
	\mathbf{b}_{Li} = & \begin{bmatrix}
	\tfrac{1}{3} \,  N_{i,x}  & \tfrac{1}{3} \,  N_{i,y} & \tfrac{1}{3} \,  N_{i,z} \\
	\tfrac{1}{3} \,  N_{i,x}  & -\tfrac{1}{3} \,  N_{i,y} & 0 \\ 0 & \tfrac{1}{3} \, N_{i,y}  & - \tfrac{1}{3} \,  N_{i,z} \\ - \tfrac{1}{3} \,  N_{i,x}  & 0 & \tfrac{1}{3} \,  N_{i,z} \\ 0 &  N_{i,z}  &  N_{i,y} \\ 0 & N_{i,z}  &   N_{i,y} \\  N_{i,y}  &   N_{i,x} & 0 \end{bmatrix}  \\
	\intertext{and}
	\mathbf{\Delta}^T  = &
	\begin{Bmatrix}
	u_1, v_1, w_1, u_2, v_2, w_2 ...,u_n, v_n, w_n
	\end{Bmatrix}
	\end{align}
\end{subequations}
The first nonlinear strain terms can be written as 
\begin{equation}
\begin{aligned}
\mathbf{E}_{N1} & =  \begin{Bmatrix}
\mathrm \xi_{L} \\
\mathrm \varepsilon_{1N} \\
\mathrm \varepsilon_{2N} \\
\mathrm \varepsilon_{3N} \\
\mathrm \gamma_{1N} \\
\mathrm \gamma_{2N} \\
\mathrm \gamma_{3N} \end{Bmatrix} =
\begin{Bmatrix}
\tfrac{1}{6} \,  \left( -u_{,x}^2 - 2 \, u_{,y} \, v_{,x}  +  w_{,x}^2  \right)\\
\tfrac{1}{6} \,  \left( -u_{,x}^2 + 2 \, v_{,x}^2 +  w_{,x}^2 \right) \\
\tfrac{1}{6} \,  \left( - v_{,x}^2 \right) \\
\tfrac{1}{6} \,  \left( u_{,x}^2 - v_{,x}^2 -  w_{,x}^2  \right) \\ 
2 \, u_{,x} \, v_{,z} - u_{,z} \, v_{,x} - v_{,x} \, w_{,x} \\
 - 2 \, u_{,x} \, v_{,z} \\ 
 - u_{,x} \, u_{,y} - 2 \, u_{,x} \, v_{,x}\end{Bmatrix} \\
 & = \frac{1}{2} \, \begin{bmatrix}
-\tfrac{1}{3} \, \partial u / \partial x &  - \tfrac{2}{3} \, \partial u / \partial y & \tfrac{1}{3} \, \partial w / \partial x  \\
-\tfrac{1}{3} \, \partial u / \partial x &  \tfrac{2}{3} \, \partial v / \partial x & \tfrac{1}{3} \, \partial w / \partial x  \\
0  & -\tfrac{1}{3} \, \partial v / \partial x & 0 \\
\tfrac{1}{3} \, \partial u / \partial x &  - \tfrac{1}{3} \, \partial v / \partial x & - \tfrac{1}{3} \, \partial w / \partial x  \\
4 \, \partial v / \partial z &  - 2 \, \partial u / \partial z & - 2 \,  \partial v / \partial x  \\
- 4 \, \partial v / \partial z &  0 & 0  \\
- 2 \, \partial u / \partial y &  - 4 \, \partial u / \partial x & 0   \end{bmatrix} \, \begin{Bmatrix}
\partial u / \partial x\\
\partial v / \partial x \\
\partial w / \partial x
\end{Bmatrix}
= \tfrac{1}{2} \, [\mathbf{A}_{N1}] \, [\boldsymbol{\theta}_{N1}]
\end{aligned}
\end{equation}

the derivative of displacement can be related to the nodal parameters via
\begin{equation}
[\boldsymbol{\theta}_{N1}] =  \begin{Bmatrix}
\partial u / \partial x\\
\partial v / \partial x \\
\partial w / \partial x
\end{Bmatrix}
= \begin{Bmatrix}
\sum\nolimits_{i=1}^5 N_{i,x} \, u_i\\
\sum\nolimits_{i=1}^5 N_{i,x} \, v_i \\
\sum\nolimits_{i=1}^5 N_{i,x} \, w_i
\end{Bmatrix} 
= \begin{bmatrix}
[\mathbf{h}_{N1}], & [\mathbf{h}_{N2}], & [\mathbf{h}_{N3}], & [\mathbf{h}_{N4}]
\end{bmatrix}  \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix}  
= [\mathbf{H}_{N1}] \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix} 
\end{equation}
where 
\begin{equation}
\mathbf{h}_{Ni} = \begin{bmatrix}
N_{i,x} &  0 & 0  \\
0 & N_{i,x} & 0  \\
0 & 0 & N_{i,x}\end{bmatrix} 
\end{equation}
hence $\mathbf{B}_{N1}$ become
\begin{equation}
\mathbf{B}_{N1} = [\mathbf{A}_{N1}] \, [\mathbf{H}_{N1}] = \begin{bmatrix}
[\mathbf{b}_{N1}], & [\mathbf{b}_{N2}], & [\mathbf{b}_{N3}], & [\mathbf{b}_{N4}] 
\end{bmatrix} 
\end{equation}
where
\begin{equation}
\mathbf{b}_i = \begin{bmatrix}

-\tfrac{1}{3} \, \partial u / \partial x &  - \tfrac{2}{3} \, \partial u / \partial y & \tfrac{1}{3} \, \partial w / \partial x  \\
-\tfrac{1}{3} \, \partial u / \partial x &  \tfrac{2}{3} \, \partial v / \partial x & \tfrac{1}{3} \, \partial w / \partial x  \\
0  & -\tfrac{1}{3} \, \partial v / \partial x & 0 \\
\tfrac{1}{3} \, \partial u / \partial x &  - \tfrac{1}{3} \, \partial v / \partial x & - \tfrac{1}{3} \, \partial w / \partial x  \\
4 \, \partial v / \partial z &  - 2 \, \partial u / \partial z & - 2 \,  \partial v / \partial x  \\
- 4 \, \partial v / \partial z &  0 & 0  \\
- 2 \, \partial u / \partial y &   - 4 \, \partial u / \partial x & 0   \end{bmatrix}  \, \begin{bmatrix}
N_{i,x} &  0 & 0  \\
0 & N_{i,x} & 0  \\
0 & 0 & N_{i,x} \end{bmatrix} 
\end{equation}
The second nonlinear strain terms can be written as 
\begin{equation}
\begin{aligned}
\mathbf{E}_{N2} & =  \begin{Bmatrix}
\mathrm \xi_{L} \\
\mathrm \varepsilon_{1N} \\
\mathrm \varepsilon_{2N} \\
\mathrm \varepsilon_{3N} \\
\mathrm \gamma_{1N} \\
\mathrm \gamma_{2N} \\
\mathrm \gamma_{3N} \end{Bmatrix} =
\begin{Bmatrix}
\tfrac{1}{6} \,  \left( - v_{,y}^2 - w_{,y}^2  \right)\\
\tfrac{1}{6} \,  \left( 2 \, u_{,y} \, v_{,x} + 2 v_{,y}^2 -  w_{,y}^2 \right) \\
\tfrac{1}{6} \,  \left( - 2 \, u_{,y} \, v_{,x} - v_{,y}^2 + 3 \, w_{,y}^2 \right) \\
\tfrac{1}{6} \,  \left(-2 \, w_{,y}^2 \right) \\ 
- u_{,y} \, w_{,x} - 2 \, v_{,y} \, w_{,y} + w_{,y} \, w_{,z} \\
u_{,y} \, u_{,z} - 2 \, u_{,x} \, w_{,y} \\ 
 v_{,x} \, v_{,y}  + w_{,x} \, w_{,y} \end{Bmatrix} \\
& = \frac{1}{2} \, \begin{bmatrix}
0 &  - \tfrac{1}{3} \, \partial v / \partial y & \tfrac{1}{3} \, \partial w / \partial y  \\
\tfrac{2}{3} \, \partial v / \partial x &  \tfrac{2}{3} \, \partial v / \partial y & - \tfrac{1}{3} \, \partial w / \partial y  \\
-\tfrac{2}{3} \, \partial v / \partial x  & -\tfrac{1}{3} \, \partial v / \partial y & \partial w / \partial y \\
0 & 0 & - \tfrac{2}{3} \, \partial w / \partial y   \\
- 2 \, \partial w / \partial x &  - 4 \, \partial w / \partial y & 2 \,  \partial w / \partial z  \\
2 \, \partial u / \partial z &  0 & - 4 \, \partial u / \partial x  \\
0 &  2 \, \partial v / \partial x &  2 \, \partial w / \partial x  \end{bmatrix} \, \begin{Bmatrix}
\partial u / \partial y\\
\partial v / \partial y \\
\partial w / \partial y
\end{Bmatrix}
= \tfrac{1}{2} \, [\mathbf{A}_{N2}] \, [\boldsymbol{\theta}_{N2}]
\end{aligned}
\end{equation}
the derivative of displacement can be related to the nodal parameters via
\begin{equation}
[\boldsymbol{\theta}_{N2}] =  \begin{Bmatrix}
\partial u / \partial y\\
\partial v / \partial y \\
\partial w / \partial y
\end{Bmatrix}
= \begin{Bmatrix}
\sum\nolimits_{i=1}^5 N_{i,y} \, u_i\\
\sum\nolimits_{i=1}^5 N_{i,y} \, v_i \\
\sum\nolimits_{i=1}^5 N_{i,y} \, w_i
\end{Bmatrix} 
= \begin{bmatrix}
[\mathbf{h}_{N1}], & [\mathbf{h}_{N2}], & [\mathbf{h}_{N3}], & [\mathbf{h}_{N4}] 
\end{bmatrix}  \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix}  
= [\mathbf{H}_{N2}] \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix} 
\end{equation}
where 
\begin{equation}
\mathbf{h}_{Ni} = \begin{bmatrix}
N_{i,y} &  0 & 0  \\
0 & N_{i,y} & 0  \\
0 & 0 & N_{i,y} \end{bmatrix} 
\end{equation}
hence $\mathbf{B}_{N2}$ become
\begin{equation}
\mathbf{B}_{N2} = [\mathbf{A}_{N2}] \, [\mathbf{H}_{N2}] = \begin{bmatrix}
[\mathbf{b}_{N1}], & [\mathbf{b}_{N2}], & [\mathbf{b}_{N3}], & [\mathbf{b}_{N4}]
\end{bmatrix} 
\end{equation}
where
\begin{equation}
\mathbf{b}_{Ni} = \begin{bmatrix}
0 &  - \tfrac{1}{3} \, \partial v / \partial y & \tfrac{1}{3} \, \partial w / \partial y  \\
\tfrac{2}{3} \, \partial v / \partial x &  \tfrac{2}{3} \, \partial v / \partial y & - \tfrac{1}{3} \, \partial w / \partial y  \\
-\tfrac{2}{3} \, \partial v / \partial x  & -\tfrac{1}{3} \, \partial v / \partial y & \partial w / \partial y \\
0 & 0 & - \tfrac{2}{3} \, \partial w / \partial y   \\
- 2 \, \partial w / \partial x &  - 4 \, \partial w / \partial y & 2 \,  \partial w / \partial z  \\
2 \, \partial u / \partial z &  0 & - 4 \, \partial u / \partial x  \\
0 &  2 \, \partial v / \partial x &  2 \, \partial w / \partial x  \end{bmatrix} \, \begin{bmatrix}
N_{i,y} &  0 & 0  \\
0 & N_{i,y} & 0  \\
0 & 0 & N_{i,y}  \end{bmatrix} 
\end{equation}

The third nonlinear strain terms can be written as 
\begin{equation}
\begin{aligned}
\mathbf{E}_{N3} & =  \begin{Bmatrix}
\mathrm \xi_{L} \\
\mathrm \varepsilon_{1N} \\
\mathrm \varepsilon_{2N} \\
\mathrm \varepsilon_{3N} \\
\mathrm \gamma_{1N} \\
\mathrm \gamma_{2N} \\
\mathrm \gamma_{3N} \end{Bmatrix} =
\begin{Bmatrix}
\tfrac{1}{6} \,  \left( u_{,z}^2 - v_{,z}^2 - 4 \, v_{,z} \, w_{,y} - w_{,z}^2   \right)\\
0 \\
\tfrac{1}{6} \,  \left( - u_{,z}^2 + v_{,z}^2 + 4 \, v_{,z} \, w_{,y} + w_{,z}^2  \right) \\
\tfrac{1}{6} \,  \left( u_{,z}^2 - v_{,z}^2 - w_{,z}^2 - 4 \, v_{,z} \, w_{,y}\right) \\ 
- v_{,y} \, v_{,z}  \\
v_{,y} \, v_{,z} + w_{,y} \, w_{,z} \\ 
0 \end{Bmatrix} \\
& = \frac{1}{2} \, \begin{bmatrix}
\tfrac{1}{3} \, \partial u / \partial z &  - \tfrac{1}{3} \, \partial v / \partial z - \tfrac{4}{3} \, \partial w / \partial y & - \tfrac{1}{3} \, \partial w / \partial z   \\
0 &  0 & 0  \\
- \tfrac{1}{3} \, \partial u / \partial z &  \tfrac{1}{3} \, \partial v / \partial z + \tfrac{4}{3} \, \partial w / \partial y & \tfrac{1}{3} \, \partial w / \partial z \\
\tfrac{1}{3} \, \partial u / \partial z &  - \tfrac{1}{3} \, \partial v / \partial z - \tfrac{4}{3} \, \partial w / \partial y & - \tfrac{1}{3} \, \partial w / \partial z \\
0 &  -2 \, \partial v / \partial y & 0  \\
0 &  2 \, \partial v / \partial y & 2 \, \partial w / \partial y  \\
0 &  0 &  0  \end{bmatrix} \, \begin{Bmatrix}
\partial u / \partial z\\
\partial v / \partial z \\
\partial w / \partial z
\end{Bmatrix}
= \tfrac{1}{2} \, [\mathbf{A}_{N3}] \, [\boldsymbol{\theta}_{N3}]
\end{aligned}
\end{equation}
the derivative of displacement can be related to the nodal parameters via
\begin{equation}
[\boldsymbol{\theta}_{N3}] =  \begin{Bmatrix}
\partial u / \partial z\\
\partial v / \partial z \\
\partial w / \partial z
\end{Bmatrix}
= \begin{Bmatrix}
\sum\nolimits_{i=1}^5 N_{i,z} \, u_i\\
\sum\nolimits_{i=1}^5 N_{i,z} \, v_i \\
\sum\nolimits_{i=1}^5 N_{i,z} \, w_i
\end{Bmatrix} 
= \begin{bmatrix}
[\mathbf{h}_{N1}], & [\mathbf{h}_{N2}], & [\mathbf{h}_{N3}], & [\mathbf{h}_{N4}] 
\end{bmatrix}  \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix}  
= [\mathbf{H}_{N3}] \begin{Bmatrix} \boldsymbol{\Delta} \end{Bmatrix} 
\end{equation}
where 
\begin{equation}
\mathbf{h}_{Ni} = \begin{bmatrix}
N_{i,z} &  0 & 0  \\
0 & N_{i,z} & 0  \\
0 & 0 & N_{i,z} \end{bmatrix} 
\end{equation}
hence $\mathbf{B}_{N3}$ become
\begin{equation}
\mathbf{B}_{N3} = [\mathbf{A}_{N3}] \, [\mathbf{H}_{N3}] = \begin{bmatrix}
[\mathbf{b}_{N1}], & [\mathbf{b}_{N2}], & [\mathbf{b}_{N3}], & [\mathbf{b}_{N4}]
\end{bmatrix} 
\end{equation}
where
\begin{equation}
\mathbf{b}_{Ni} = \begin{bmatrix}
\tfrac{1}{3} \, \partial u / \partial z &  - \tfrac{1}{3} \, \partial v / \partial z - \tfrac{4}{3} \, \partial w / \partial y & - \tfrac{1}{3} \, \partial w / \partial z   \\
0 &  0 & 0  \\
- \tfrac{1}{3} \, \partial u / \partial z &  \tfrac{1}{3} \, \partial v / \partial z + \tfrac{4}{3} \, \partial w / \partial y & \tfrac{1}{3} \, \partial w / \partial z \\
\tfrac{1}{3} \, \partial u / \partial z &  - \tfrac{1}{3} \, \partial v / \partial z - \tfrac{4}{3} \, \partial w / \partial y & - \tfrac{1}{3} \, \partial w / \partial z \\
0 &  -2 \, \partial v / \partial y & 0  \\
0 &  2 \, \partial v / \partial y & 2 \, \partial w / \partial y  \\
0 &  0 &  0 \end{bmatrix} \, \begin{bmatrix}
N_{i,z} &  0 & 0  \\
0 & N_{i,z} & 0  \\
0 & 0 & N_{i,z}  \end{bmatrix} 
\end{equation}

In order to be able to evaluate the nonlinear stiffness matrix, $[\mathbf{\bar{B}}]$ should be established as the summation of $ \mathbf{B}_{N1}$, $\mathbf{B}_{N2}$ and $\mathbf{B}_{N3}$.
Hence, the stress stiffness matrix for a 3-D alveolar volume take the form of
\begin{equation}
\mathbf{K}_\mathbf{S} = \int_{V}  \mathrm{d} \mathbf{B}_N^{\mathsf{T}} \, \mathbf{T} \, |\mathbf{J}|  \, \mathrm{d} \xi \,  \mathrm{d} \eta \, \mathrm{d} \zeta =  \sum_{i=1}^{n} \sum_{j=1}^{n}  \sum_{k=1}^{n}    \mathrm{d} \mathbf{B}_N^{\mathsf{T}} \, \mathbf{T} \, |\mathbf{J}| \, \mathrm{w}_i \mathrm{w}_j \mathrm{w}_k
\label{stressstifvol}
\end{equation}
where $n$ stands for number of Gauss points. Table~\ref{tabQuadraturetetra}
By taking the variation of Eq.~(\ref{straindis}) and substituting the definition of first and second nonlinear strain displacement matrices, the total nonlinear strain displacement matrix becomes
\begin{equation}
\mathrm{d}[\mathbf{B}_N]^{\mathsf{T}} = [\mathbf{H}_1^{\mathsf{T}}] \mathrm{d} [\mathbf{A}_1^{\mathsf{T}}] + [\mathbf{H}_2^{\mathsf{T}}] \mathrm{d} [\mathbf{A}_2^{\mathsf{T}}] + [\mathbf{H}_3^{\mathsf{T}}] \mathrm{d} [\mathbf{A}_3^{\mathsf{T}}]
\end{equation}
which on substituting into Eq.~(\ref{stressstifvol}) gives 
\begin{equation}
\mathbf{K_\mathbf{S}} \mathrm{d} \boldsymbol{\Delta} = \int_A \left(
[\mathbf{H}_1^{\mathsf{T}}] \mathrm{d} [\mathbf{A}_1^{\mathsf{T}}] + [\mathbf{H}_2^{\mathsf{T}}] \mathrm{d} [\mathbf{A}_2^{\mathsf{T}}] + [\mathbf{H}_3^{\mathsf{T}}] \mathrm{d} [\mathbf{A}_3^{\mathsf{T}}] \right) \, \begin{Bmatrix} s^{\pi} \\ s^{\sigma_1} \\ s^{\sigma_2}  \\ s^{\tau_1} \\ s^{\tau_2} \\ s^{\tau_3} \end{Bmatrix} \, \mathrm{d} A
\end{equation}
However, using the mathematical properties of the matrix $\mathbf{A}$, the following expression will appear
\begin{equation}
\begin{aligned}
 & \mathrm{d} [\mathbf{A}_1^{\mathsf{T}}] \, \begin{Bmatrix} s^{\pi} \\ s^{\sigma_1} \\ s^{\sigma_2} \\ s^{\tau_1} \\ s^{\tau_2} \\ s^{\tau_3}  \end{Bmatrix} = 
\begin{bmatrix}s^{\pi} & s^{\tau_1} & s^{\tau_3}\\ 
s^{\tau_1} & s^{\sigma_1} & s^{\tau_2} \\ 
s^{\tau_3} & s^{\tau_2} & s^{\sigma_2} \end{bmatrix} \, [\mathbf{H}_1] \, \mathrm{d} \boldsymbol{\Delta} \\
& \mathrm{d} [\mathbf{A}_2^{\mathsf{T}}] \, \begin{Bmatrix}s^{\pi} \\ s^{\sigma_1} \\ s^{\sigma_2}  \\ s^{\tau_1} \\ s^{\tau_2} \\ s^{\tau_3}  \end{Bmatrix} = 
 \begin{bmatrix} s^{\pi} & s^{\tau_1} & s^{\tau_3}\\ 
 s^{\tau_1} & s^{\sigma_1} & s^{\tau_2} \\ 
 s^{\tau_3} & s^{\tau_2} & s^{\sigma_2}  \end{bmatrix} \, [\mathbf{H}_2] \, \mathrm{d} \boldsymbol{\Delta}\\
 & \mathrm{d} [\mathbf{A}_3^{\mathsf{T}}] \, \begin{Bmatrix}s^{\pi} \\ s^{\sigma_1} \\ s^{\sigma_2}  \\ s^{\tau_1} \\ s^{\tau_2} \\ s^{\tau_3}  \end{Bmatrix} = 
 \begin{bmatrix} s^{\pi} & s^{\tau_1} & s^{\tau_3}\\ 
 s^{\tau_1} & s^{\sigma_1} & s^{\tau_2} \\ 
 s^{\tau_3} & s^{\tau_2} & s^{\sigma_3}  \end{bmatrix} \, [\mathbf{H}_3] \, \mathrm{d} \boldsymbol{\Delta}
 \end{aligned}
\end{equation}
and finally the stress/geometric stiffness matrix can be expressed as follow
\begin{equation}
\begin{aligned}
\mathbf{K_{\mathbf{S}}} & = \sum_{i=1}^{n}  \sum_{j=1}^{n}  \sum_{k=1}^{n} [\mathbf{H}_1]^{\mathsf{T}}  \begin{bmatrix} s^{\pi} & s^{\tau_1} & s^{\tau_3}\\ 
s^{\tau_1} & s^{\sigma_1} & s^{\tau_2} \\ 
s^{\tau_3} & s^{\tau_2} & s^{\sigma_2}
\end{bmatrix} \, [\mathbf{H}_1] \, |\mathbf{J}|  \mathrm{w}_i \mathrm{w}_j \mathrm{w}_k \\
& + \sum_{i=1}^{n}  \sum_{j=1}^{n}  \sum_{k=1}^{n} [\mathbf{H}_2]^{\mathsf{T}}  \begin{bmatrix} s^{\pi} & s^{\tau_1} & s^{\tau_3}\\ 
s^{\tau_1} & s^{\sigma_1} & s^{\tau_2} \\ 
s^{\tau_3} & s^{\tau_2} & s^{\sigma_2}
\end{bmatrix} \, [\mathbf{H}_2] \, |\mathbf{J}|  \, \mathrm{w}_i \mathrm{w}_j \mathrm{w}_k \\
& + \sum_{i=1}^{n}  \sum_{j=1}^{n}  \sum_{k=1}^{n} [\mathbf{H}_3]^{\mathsf{T}}  \begin{bmatrix} s^{\pi} & s^{\tau_1} & s^{\tau_3}\\ 
s^{\tau_1} & s^{\sigma_1} & s^{\tau_2} \\ 
s^{\tau_3} & s^{\tau_2} & s^{\sigma_2}
\end{bmatrix} \, [\mathbf{H}_3] \, |\mathbf{J}|  \, \mathrm{w}_i \mathrm{w}_j \mathrm{w}_k
\end{aligned}
\end{equation}
The small/linear displacement stiffness matrix for tetrahedron is evaluated numerically as 
\begin{equation}
\mathbf{K}_{L} = \int_{V} \mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L \, |\mathbf{J}| \,  \mathrm{d} \xi \,  \mathrm{d} \eta \,  \mathrm{d} \zeta =  \sum_{i=1}^{n}  \sum_{j=1}^{n}  \sum_{k=1}^{n}  \mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L \, |\mathbf{J}|  \, \mathrm{w}_i \mathrm{w}_j \mathrm{w}_k
\end{equation}
The large/nonlinear displacement stiffness matrix for chord can be presented as follow
\begin{equation}
\mathbf{K}_{N} = \int_{V} \mathbf{D} \, |\mathbf{J}|\, \mathrm{d} \xi \, \mathrm{d} \eta \, \mathrm{d} \zeta
= \sum_{i=1}^{n}  \sum_{j=1}^{n}  \sum_{k=1}^{n}  \mathbf{D} \, |\mathbf{J}| \, \mathrm{w}_i \mathrm{w}_j \mathrm{w}_k
\end{equation}
where $\mathbf{D}$ have the expression 
\begin{equation}
\mathbf{D} = \mathbf{B}_L^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_N \, + \mathbf{B}_N^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_L \, + \mathbf{B}_N^{\mathsf{T}} \, \mathbf{M} \, \mathbf{B}_N
\end{equation}


\section{Force Vector}
%In the lung structure, the lung tissue(elastin and collagen) and the alveoli are two sources of force trying to collapse the lung. These inward forces are called the forces of recoil.  Inside of the alveoli, there is a fluid that makes the surface moist(a membrane of fluid is sticking to the surface) that is making an interface with the air, and this air-fluid interface also causes pressure inwards which try to collapse the alveoli called tension. The lung tissue is a third, and the fluid surface tension is $2/3$ of the total recoil. 

%The expansile force is the transpulmonary force, which is the difference between the fluid in the pleural cavity that is called pleural pressure ($-5 cm H_2O$ at rest) and the pressure inside the alveoli that is called alveolar pressure ($0 cm H_2O$ at rest). 

%If the alveolus is filled with air along with a pure water layer(air-fluid interface), the water is going to try to contract and pull the alveolus inverse. That is the tension created by the fluid-air interface. 
%Since the alveolus is squeezing, the air inside it develops pressure on the alveolus.
%This pressure and the recoiling forces and the expansile forces have to become equal for the alveolus to stay stable. 

The principle of stationary potential energy with the Rayleigh-Ritz approach, Eq.~(\ref{principle}) determines the basis of finite element stress analysis. The internal strain energy is balanced with the potential energy of applied internal and external loads on the body.

The virtual work done by external forces $\delta{W}$ in Eq.~(\ref{principle}) can be expressed as follow
\begin{equation}
	\begin{aligned}
	\delta{W} = \int_{S} \, \mathbf{t} \, \delta \mathbf{u} \, \mathrm{d} S
	 = \int_{S} \, \mathbf{t} \, \mathbf{N} \, \mathrm{d} \boldsymbol{\Delta} \, \mathrm{d} S
	= \left( \int_{S} \, \mathbf{N}^{\mathsf{T}} \, \mathbf{t} \, \mathrm{d} S \right) \, \mathrm{d} \boldsymbol{\Delta}
	\end{aligned}
\end{equation}
where $\mathrm{d} S$ denotes the surface element and $\mathbf{t}$ is the surface traction vector (per unit surface area) at current time. Hence, the external FE force vectors are
\begin{equation}
    \mathbf{F} = \int_{S} \, \mathbf{N}^{\mathsf{T}} \, \mathbf{t} \, \mathrm{d} S 
\end{equation}
with $ \mathbf{F} $ being the deformation gradient.


\subsection{Force Vector for a Chord}

The force vector of the 1-D alveolar chord that is evaluated numerically in its natural co-ordinate system can be described as
\begin{equation}
\mathbf{F}_{1D} = \int_{\Gamma} \mathbf{N}^{\mathsf{T}} \, \mathbf{t} \, \mathrm{d} x  = \int_{-1}^{1} \mathbf{N}^{\mathsf{T}}\, \mathbf{t} \, \mathbf{J}\,  \mathrm{d} \xi =  \sum_{i=1}^{n} \mathbf{N}^{\mathsf{T}} \, \mathbf{t} \, \mathbf{J} \, \mathrm{w}_i
\end{equation}
where $\mathrm{w}_i$ being the  weighting coefficients of the Gauss integration rule, $\mathbf{N}$ is the shape function matrix for chord, and $\mathbf{t}$ is the traction on the septal chord that is selected so that $\mathbf{t} = \mathbf{t}^c + \mathbf{t}^e $ as established in part 4 via engineering stress carried by collagen and elastin fibers.
Table~\ref{tabQuadrature1D} demonstrates the values of $\xi$ and $\mathrm{w}_i$ for $n = 1, 2$, and $3$ Gauss integration points.

\subsection{Force Vector for a Pentagon}
The boundary of a two dimensional pentagon consist of line segments, which can be considered as one-dimensional chord. Hence, the evaluation of the boundary integrals on pentagon amounts to evaluating line integrals. Once the interpolation function for a pentagon are evaluated on the boundary of pentagon, we obtain the corresponding chordal interpolation functions \cite{Reddy93}.
Thus, the force vector $\mathbf{F}_{2D}$  for a pentagon can be obtained by integral over all sides of pentagon as follow
\begin{equation}
\begin{aligned}
\mathbf{F}_{2D}  = \oint_{\Gamma} \mathbf{N}^{\mathsf{T}} \, \mathbf{t} \, \mathrm{d} S & = \int_{\Gamma_{12}} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{12} \,|\mathbf{J}| \, \mathrm{d} \xi + \int_{\Gamma_{23}} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{23} \,|\mathbf{J}| \, \mathrm{d} \xi + \int_{\Gamma_{34}} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{34} \,|\mathbf{J}| \, \mathrm{d} \xi \\
& + \int_{\Gamma_{45}} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{45} \, \,|\mathbf{J}| \, \mathrm{d} \xi + \int_{\Gamma_{51}} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{51} \,|\mathbf{J}| \, \mathrm{d} \xi \\
& = \sum_{i=1}^{n} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{12} \,|\mathbf{J}| \, \mathrm{w}_i + \sum_{i=1}^{n} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{23} \,|\mathbf{J}| \, \mathrm{w}_i + \sum_{i=1}^{n} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{34} \,|\mathbf{J}| \, \mathrm{w}_i \\
& + \sum_{i=1}^{n} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{45} \, \,|\mathbf{J}| \, \mathrm{w}_i + \sum_{i=1}^{n} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{51} \,|\mathbf{J}| \, \mathrm{w}_i
\end{aligned}
\end{equation}
wherein $\mathbf{N}$ being the shape function matrix of a chord with the matrix dimension of a pentagon, $|\mathbf{J}|$ being the determinant of the Jacobian for a 1-D chord, $\mathrm{w}_i$ denotes the natural weight of the chord, $\mathrm{d} S$ is the arc-length of an infinitesimal line element along the boundary, and $\mathbf{t}$ is the traction vector on each edge of the pentagon as follow
\begin{equation}
	\mathbf{t} = \boldsymbol{\sigma}^{\mathsf{T}} \cdot \mathbf{n} 
\end{equation}
where $ \mathbf{n} $ is the normal vector to each sides of pentagon on which the traction acts and $ \boldsymbol{\sigma} $ is the Cauchy stress as established in part 4.

\subsection{Force Vector for a Tetrahedron}

The analysis to find the force vector of a tetrahedron is used to reach the force vector of whole alveolar volume.
The matrix of shape functions Eq.~(\ref{shape3D}) is used to obtain the force vector for tetrahedron.
The force vector $\mathbf{F}_{3D}$ can be specified as follow
\begin{equation}
\begin{aligned}
\mathbf{F}_{3D} &= \oint_{A} \mathbf{N}^{\mathsf{T}} \, \mathbf{t} \, \mathrm{d} A = \int_{\triangle_{1}} \int_{\triangle_{1}} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{\triangle_{1}} \,|\mathbf{J}| \, \mathrm{d} \xi \, \mathrm{d} \eta  + \int_{\triangle_{2}} \int_{\triangle_{2}} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{\triangle_{2}} \,|\mathbf{J}| \, \mathrm{d} \xi \, \mathrm{d} \eta \\
& + \int_{\triangle_{3}} \int_{\triangle_{3}} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{\triangle_{3}} \,|\mathbf{J}| \, \mathrm{d} \xi \, \mathrm{d} \eta + \int_{\triangle_{4}} \int_{\triangle_{4}} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{\triangle_{4}} \,|\mathbf{J}| \, \mathrm{d} \xi \, \mathrm{d} \eta \\
 & = \sum_{i=1}^{n} \sum_{j=1}^{n} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{\triangle_{1}} \,|\mathbf{J}| \, \mathrm{w}_i \mathrm{w}_j + \sum_{i=1}^{n} \sum_{j=1}^{n} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{\triangle_{2}} \,|\mathbf{J}| \, \mathrm{w}_i \mathrm{w}_j \\
 & + \sum_{i=1}^{n} \sum_{j=1}^{n} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{\triangle_{3}} \,|\mathbf{J}| \, \mathrm{w}_i \mathrm{w}_j + \sum_{i=1}^{n} \sum_{j=1}^{n} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{\triangle_{4}} \,|\mathbf{J}| \, \mathrm{w}_i \mathrm{w}_j
 \end{aligned}
\end{equation}
wherein $ \mathbf{N}$ being the shape function matrix for a triangle with the matrix dimension of a tetrahedron,  $|\mathbf{J}|$ being the determinant of the Jacobian for triangle, $n$ stands for number of Gauss points, $\mathrm{w}_i$ and $\mathrm{w}_j$ are the natural weight of the triangle from Table~\ref{tabGaussPointsTriangle}, and $\mathbf{t}$ is the surface traction on the triangle surface. $\oiint$ denotes the integral over the surface boundary of the tetrahedron. We compute the integral over one of the tetrahedrone's surfaces on which makes one triangles of a pentagon because by internal stress equilibrium, those portions cancel with like contributions from the neighboring elements in the assembled force vector of the structure. Hence, the force vector for a tetrahedron takes the form of

\begin{equation}
\mathbf{F}_{3D} = \sum_{i=1}^{n} \sum_{j=1}^{n} \mathbf{N}^{\mathsf{T}} \, \mathbf{t}_{\triangle_{1}} \,|\mathbf{J}| \, \mathrm{w}_i \mathrm{w}_j 
\end{equation}



\begin{table}
	\centering
	\begin{tabular}{|c|rrr|}
		\hline
		node & $\xi$ co-ordinate   & 
		$\eta$ co-ordinate & weight \\   \hline        
		& \multicolumn{3}{|c|}{Exact for Polynomials of Degree $1^{\phantom{|^|}}$} \\ 
		\hline
		1 & 1/3 & 1/3 & 1.0 \\ 
		\hline
		& \multicolumn{3}{|c|}{Exact for Polynomials of Degree $2^{\phantom{|^|}}$} \\ 
		\hline
		1 & 2/3 & 1/6 & 1/3\\
		2 & 1/6 & 1/6 & 1/3\\
		3 & 1/6 & 2/3 & 1/3\\ 
		\hline
		& \multicolumn{3}{|c|}{Exact for Polynomials of Degree $3^{\phantom{|^|}}$} \\ \hline
		1 & 1/3 & 1/3 & -27/48 \\
		2 & 3/5 & 1/5 & 25/48 \\
		3 & 1/5 & 1/5 & 25/48 \\ 
		4 & 1/5 & 3/5 & 25/48 \\
		\hline
	\end{tabular}
	\caption{Generalized, Gaussian, weights and nodes for integrating over a triangle in its natural co-ordinate system.}
	\label{tabGaussPointsTriangle}
\end{table}

